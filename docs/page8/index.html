<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Spare no effort ; Leave no regret &#8211; Max 乎~</title>
<meta name="description" content="Describe this nonsense.">
<meta name="keywords" content="Jekyll, theme, themes, responsive, blog, modern">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Spare no effort ; Leave no regret">
<meta property="og:description" content="Describe this nonsense.">
<meta property="og:url" content="https://jhaoheng.github.io/blogpost/page8/">
<meta property="og:site_name" content="Max 乎~">





<link rel="canonical" href="https://jhaoheng.github.io/blogpost/page8/">
<link href="https://jhaoheng.github.io/blogpost/feed.xml" type="application/atom+xml" rel="alternate" title="Max 乎~ Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="https://jhaoheng.github.io/blogpost/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="https://jhaoheng.github.io/blogpost/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="https://jhaoheng.github.io/blogpost/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="https://jhaoheng.github.io/blogpost/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://jhaoheng.github.io/blogpost/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://jhaoheng.github.io/blogpost/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://jhaoheng.github.io/blogpost/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://jhaoheng.github.io/blogpost/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="https://jhaoheng.github.io/blogpost/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="https://jhaoheng.github.io/blogpost/images/avatar2.jpg" alt="Max Hu photo" class="author-photo">
					<h4>Max Hu</h4>
					<p>developer</p>
				</li>
				<li><a href="https://jhaoheng.github.io/blogpost/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:jhaoheng@gmail.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				
				
				
				
				<li>
					<a href="https://github.com/https://github.com/jhaoheng"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="https://jhaoheng.github.io/blogpost/posts/">All Posts</a></li>
				<li><a href="https://jhaoheng.github.io/blogpost/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  <div class="image-credit">Image source: <a href="http://www.dargadgetz.com/ios-7-abstract-wallpaper-pack-for-iphone-5-and-ipod-touch-retina/">dargadgetz</a></div><!-- /.image-credit -->
  
    <div class="entry-image">
      <img src="https://jhaoheng.github.io/blogpost/images/abstract-1.jpg" alt="Spare no effort ; Leave no regret">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Max 乎~</h1>
      <h2>Spare no effort ; Leave no regret</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2017-07-05T03:56:00+08:00"><a href="https://jhaoheng.github.io/blogpost/docker/sublime/Docker-Sublime/">July 05, 2017</a></time></span><span class="author vcard"><span class="fn"><a href="https://jhaoheng.github.io/blogpost/about/" title="About Max Hu">Max Hu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="https://jhaoheng.github.io/blogpost/docker/sublime/Docker-Sublime/" rel="bookmark" title="【Docker】use sublime to edit file in docker" itemprop="url">【Docker】use sublime to edit file in docker</a></h1>
    
  </header>
  <div class="entry-content">
    <h1 id="sublime-編輯-docker-中的檔案">sublime 編輯 docker 中的檔案</h1>

<p>docker 是個好物的原因在於，環境的穩定，無論遷移到哪個環境中，都可以保持穩定性，debug 也方便許多</p>

<p>但如何直接編輯 docker 建立後的 file？
透過 docker 中的 volume 設定好 application 與 docker 中的位置，就可以直接動態變更 docker 中的檔案資訊</p>

<h1 id="ex--php--phalcon--docker">ex : php / phalcon / docker</h1>

<p><strong>Docker Engine &gt;= 1.10.0 * Docker Compose &gt;= 1.6.2</strong></p>

<ol>
  <li><code class="highlighter-rouge">git clone git@github.com:phalcon/phalcon-compose.git</code></li>
  <li><code class="highlighter-rouge">cp variables.env.example variables.env</code></li>
  <li><code class="highlighter-rouge">docker-compose up -d</code></li>
  <li>開啟網頁 localhost:80</li>
  <li>建立檔案 <code class="highlighter-rouge">./phalcon-compose/application/public/hello.php</code>
    <ul>
      <li><code class="highlighter-rouge"><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">"world"</span><span class="p">;</span> <span class="cp">?&gt;</span></code></li>
    </ul>
  </li>
  <li>開啟網頁 localhost/hello.php</li>
</ol>

    <p><a class="btn btn-sm btn-primary" href="https://jhaoheng.github.io/blogpost/docker/sublime/Docker-Sublime/#read-more" role="button">Read more <i class="fa fa-arrow-circle-right"></i></a>
    </p>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2017-06-24T12:55:00+08:00"><a href="https://jhaoheng.github.io/blogpost/rtmp/RTMP-Youtube/">June 24, 2017</a></time></span><span class="author vcard"><span class="fn"><a href="https://jhaoheng.github.io/blogpost/about/" title="About Max Hu">Max Hu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="https://jhaoheng.github.io/blogpost/rtmp/RTMP-Youtube/" rel="bookmark" title="【RTMP】youtube to rtmp" itemprop="url">【RTMP】youtube to rtmp</a></h1>
    
  </header>
  <div class="entry-content">
    <h1 id="目的">目的</h1>
<p>將 youtube 的影片傳給 rtmp server 進行串流</p>

<h1 id="how">how</h1>
<ol>
  <li>找到 youtube 的影片</li>
  <li>進行轉檔為 mp4 : https://www.onlinevideoconverter.com/zh/success?id=b1d3e4d3e4d3g6b1
    <ul>
      <li>或者利用各種轉檔方式</li>
      <li>可下載為 file 也可直接抓取 url (但注意 url 會過期)</li>
      <li>或者把影片存成 mp4 後，放到 server 上</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">docker run --rm jrottenberg/ffmpeg:ubuntu -re -i http://... -vcodec libx264 -preset ultrafast -acodec libfaac -f flv rtmp:...</code>
    <ul>
      <li><code class="highlighter-rouge">-re</code> : Read input at native frame rate. Mainly used to simulate a grab device.  or live input stream (e.g. when reading from a file). Should not be used with actual grab devices or live input streams (where it can cause packet loss).  By default ffmpeg attempts to read the input(s) as fast as possible.  This option will slow down the reading of the input(s) to the native frame rate of the input(s). It is useful for real-time output (e.g. live streaming).</li>
      <li><code class="highlighter-rouge">http://...</code> : 輸入的 mp4 影片位置，也可用 file 來替代</li>
      <li><code class="highlighter-rouge">rmpt://...</code> : 要串流的 rtmp server 位置</li>
    </ul>
  </li>
</ol>

    <p><a class="btn btn-sm btn-primary" href="https://jhaoheng.github.io/blogpost/rtmp/RTMP-Youtube/#read-more" role="button">Read more <i class="fa fa-arrow-circle-right"></i></a>
    </p>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2017-06-21T06:59:00+08:00"><a href="https://jhaoheng.github.io/blogpost/playerhls-rtmp/">June 21, 2017</a></time></span><span class="author vcard"><span class="fn"><a href="https://jhaoheng.github.io/blogpost/about/" title="About Max Hu">Max Hu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="https://jhaoheng.github.io/blogpost/playerhls-rtmp/" rel="bookmark" title="【Player】HLS.js / video.js / jwplayer" itemprop="url">【Player】HLS.js / video.js / jwplayer</a></h1>
    
  </header>
  <div class="entry-content">
    <h1 id="rtmp-live">rtmp live</h1>

<h2 id="使用-videojs-的-issue">使用 video.js 的 issue</h2>

<p>播放後，影片會在左上角，與 player size 不符合</p>
<ul>
  <li>bug fixed : https://github.com/videojs/video-js-swf/issues/55
    <ol>
      <li>下載 https://github.com/digitalStyx/video-js-swf/blob/master/bin-debug/VideoJS.swf 到本地後</li>
      <li>在 head 中加入
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;script&gt;
   videojs.options.flash.swf = "VideoJS.swf";
 &lt;/script&gt;
</code></pre></div>        </div>
      </li>
      <li>使用參考 : https://coolestguidesontheplanet.com/videodrome/videojs/</li>
    </ol>
  </li>
</ul>

<h1 id="hls-playback">hls playback</h1>

<h2 id="如何進行-offset">如何進行 offset</h2>

<ul>
  <li>document : https://tools.ietf.org/html/draft-pantos-http-live-streaming-18#section-4.3.5.2</li>
</ul>

<ol>
  <li>version 6 以上</li>
  <li>use like below : <strong>#EXT-X-START:TIME-OFFSET=2</strong></li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#EXTM3U
#EXT-X-VERSION:7
#EXT-X-ALLOW-CACHE:YES
#EXT-X-TARGETDURATION:7
#EXT-X-MEDIA-SEQUENCE:1
#EXT-X-START:TIME-OFFSET=2

#EXTINF:7, 
1498008625670.ts
#EXTINF:6, 
1498008631711.ts
#EXTINF:6, 
1498008637927.ts

</code></pre></div></div>
<ol>
  <li>注意播放器要支援解析, EX: <code class="highlighter-rouge">https://github.com/jhaoheng/html5_hls_test/blob/master/hls.html</code></li>
</ol>

<h1 id="jwplayer-使用-flash-播放-hls--rtmp">jwplayer 使用 flash 播放 hls / rtmp</h1>

<ul>
  <li>jwplayer 提供 http / https 的網頁測試
    <ul>
      <li>http  : <code class="highlighter-rouge">http://demo.jwplayer.com/developer-tools/http-stream-tester/</code></li>
      <li>https : <code class="highlighter-rouge">https://developer.jwplayer.com/tools/stream-tester/</code></li>
    </ul>
  </li>
  <li>要讓 jwplayer 透過 flash 支援 hls 的播放，需要加入 crossdomain.xml 檔案
    <ul>
      <li>要注意的是，crossdomain.xml 的檔案內容，請勿一次全部 copy，盡量用輸入的，輸入完畢後，透過 browser 顯示，不然有可能會發生，檢查 cros 正確，但 jwplayer 會無法解析的問題，猜測應該是 copy 時，貼上帶入了奇怪的字元</li>
    </ul>
  </li>
  <li>若用 jwplayer，不指定類型，則 jwplayer 會自動根據內容自動切換 flash / html5 的播放類型，如此一來就不用特別使用 crossdomain.xml，只需在 nginx.conf 中設定 crossdomain 即可</li>
</ul>

    <p><a class="btn btn-sm btn-primary" href="https://jhaoheng.github.io/blogpost/playerhls-rtmp/#read-more" role="button">Read more <i class="fa fa-arrow-circle-right"></i></a>
    </p>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2017-06-07T16:45:00+08:00"><a href="https://jhaoheng.github.io/blogpost/aws-s3-multiple-file-upload/">June 07, 2017</a></time></span><span class="author vcard"><span class="fn"><a href="https://jhaoheng.github.io/blogpost/about/" title="About Max Hu">Max Hu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="https://jhaoheng.github.io/blogpost/aws-s3-multiple-file-upload/" rel="bookmark" title="【AWS-S3】多檔案上傳" itemprop="url">【AWS-S3】多檔案上傳</a></h1>
    
  </header>
  <div class="entry-content">
    <h1 id="env">env</h1>
<ul>
  <li>aws sdk php v3</li>
  <li>php 7.0x</li>
</ul>

<h1 id="ex">ex</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>require './vendor/autoload.php';
use Aws\S3\S3Client;
use Aws\Exception\AwsException;
use Aws\CommandPool;

$access_key = "";
$secret_access_key = "";
$bucket = "";

$client = S3Client::factory([
        "region" =&gt; "ap-northeast-1", // tokyo
        "version" =&gt; "latest", 
        'credentials' =&gt; [
            'key'    =&gt; $access_key,
            'secret' =&gt; $secret_access_key,
        ],
    ]
);

$commands = array();

$binary = file_get_contents('./images/1.jpg');
$commands[] = $client-&gt;getCommand('PutObject', [
        'Bucket' =&gt; $bucket,
        'Key'    =&gt; 'photos/photo01.jpg',
        'Body'   =&gt; $binary
    ]
);

$commands[] = $client-&gt;getCommand('PutObject', [
        'Bucket' =&gt; $bucket,
        'Key'    =&gt; 'photos/photo02.jpg',
        'Body'   =&gt; $binary
    ]
);

$pool = new CommandPool($client, $commands);
// Initiate the pool transfers
$promise = $pool-&gt;promise();

// Force the pool to complete synchronously
try {
    $result = $promise-&gt;wait();
} catch (AwsException $e) {
    // handle the error.
}
</code></pre></div></div>

    <p><a class="btn btn-sm btn-primary" href="https://jhaoheng.github.io/blogpost/aws-s3-multiple-file-upload/#read-more" role="button">Read more <i class="fa fa-arrow-circle-right"></i></a>
    </p>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2017-06-07T02:10:00+08:00"><a href="https://jhaoheng.github.io/blogpost/dockerenv/">June 07, 2017</a></time></span><span class="author vcard"><span class="fn"><a href="https://jhaoheng.github.io/blogpost/about/" title="About Max Hu">Max Hu</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="https://jhaoheng.github.io/blogpost/dockerenv/" rel="bookmark" title="【Docker】ENV" itemprop="url">【Docker】ENV</a></h1>
    
  </header>
  <div class="entry-content">
    <h1 id="env-環境變數">env 環境變數</h1>

<p>當用 docker 設定環境變數
docker 會將變數透過 bash 建立變數，並將 變數 export
故在設定 docker env 後，運行 docker，可以透過 <code class="highlighter-rouge">export -p</code> 查看所有環境變數</p>

<h1 id="indexphp">index.php</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>  
<span class="k">echo</span> <span class="nb">getenv</span><span class="p">(</span><span class="s2">"helloEnv"</span><span class="p">)</span><span class="o">.</span><span class="nx">PHP_EOL</span><span class="p">;</span>
<span class="k">echo</span> <span class="nb">getenv</span><span class="p">(</span><span class="s2">"go"</span><span class="p">)</span><span class="o">.</span><span class="nx">PHP_EOL</span><span class="p">;</span>
</code></pre></div></div>

<h1 id="step">step</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker pull jhaoheng/php_env:v1.2
// 建立 container, 設定 env
docker run -dt -e "helloEnv=sure" -e "go=ok" [image_id]
// 查看 container 中的環境變數
docker exec d11d88d32 bash -c export -p
// 放入 index.php
docker cp index.php [container_id]:/home
// 透過 php 取得環境變數
docker exec [container_id] php /home/index.php
</code></pre></div></div>

<h1 id="設計模式">設計模式</h1>
<ol>
  <li>設定好環境變數</li>
  <li>設定好取得環境變數的模板</li>
  <li>在運行 docker container 時，自動依據環境變數，建立起 config</li>
</ol>

    <p><a class="btn btn-sm btn-primary" href="https://jhaoheng.github.io/blogpost/dockerenv/#read-more" role="button">Read more <i class="fa fa-arrow-circle-right"></i></a>
    </p>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    
      
        <li><a href="https://jhaoheng.github.io/blogpost/page7/" class="btn">Previous</a></li>
      
    

    
    
      <li><a href="https://jhaoheng.github.io/blogpost">1</a></li>
    

    
    
      
      
      <li>…</li>
    

    
    
    

    
      
        
        
        
        <li><a href="https://jhaoheng.github.io/blogpost/page6/">6</a></li>
      
    
      
        
        
        
        <li><a href="https://jhaoheng.github.io/blogpost/page7/">7</a></li>
      
    
      
        <li><strong class="current-page">8</strong></li>
      
    
      
        
        
        
        <li><a href="https://jhaoheng.github.io/blogpost/page9/">9</a></li>
      
    
      
        
        
        
        <li><a href="https://jhaoheng.github.io/blogpost/page10/">10</a></li>
      
    

    
    
      <li>…</li>
    

    
      <li><a href="https://jhaoheng.github.io/blogpost/page21/">21</a></li>
    

    
    
      <li><a href="https://jhaoheng.github.io/blogpost/page9/" class="btn">Next</a></li>
    
  </ul>
</div>

</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2019 Max Hu. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="https://jhaoheng.github.io/blogpost/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="https://jhaoheng.github.io/blogpost/assets/js/scripts.min.js"></script>



          

</body>
</html>