
<!doctype html>














<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/blogpost/assets/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/blogpost/assets/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blogpost/assets/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="jhaoheng, maxhu, golang, objective-c" />








  <link rel="shortcut icon" type="image/x-icon" href="/blogpost/assets/favicon.ico?v=5.1.1" />
















<meta name="description" content="Welcome!">
<meta name="keywords" content="jhaoheng, maxhu, golang, objective-c">
<meta property="og:type" content="website">
<meta property="og:title" content="MAX 呼~">
<meta property="og:url" content="https://jhaoheng.github.io/blogpost/blogpost/page7/">
<meta property="og:site_name" content="MAX 呼~">
<meta property="og:description" content="Welcome!">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MAX 呼~">
<meta name="twitter:description" content="Welcome!">


<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blogpost',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"hide","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://jhaoheng.github.io/blogpost/blogpost"/>





  <title>MAX 呼~</title>
  
















</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  

  <div class="container sidebar-position-left page-home ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blogpost/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">MAX 呼~</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Spare No Effort, Leave No Regret</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
        
        <li class="menu-item menu-item-home">
          <a href="/blogpost/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-archives">
          <a href="/blogpost/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-tags">
          <a href="/blogpost/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            



<section id="posts" class="posts-expand">
  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/php/2016/10/22/PHP-http2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/php/2016/10/22/PHP-http2/" itemprop="url">
                【PHP】push with http2
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-22T17:05:00+08:00">
                2016-10-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/PHP" itemprop="url" rel="index">
                    <span itemprop="name">PHP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="env">env</h2>

<p>mac, osx , 10.11</p>

<h2 id="config">config</h2>

<ul>
  <li><code class="highlighter-rouge">php -i</code> , check config :
    <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7</pre></td><td class="code"><pre class="highlight"><code>[curl]
cURL support =&gt; enabled
cURL Information =&gt; 7.47.1
...
HTTP2 =&gt; Yes
...
SSL Version =&gt; OpenSSL/1.0.2g
</code></pre></td></tr></tbody></table></div>    </div>
  </li>
  <li>if php no include these config, reinstall : <code class="highlighter-rouge">brew install php70 --with-homebrew-curl</code></li>
</ul>

<h2 id="code">code</h2>

<h3 id="send-method">send method</h3>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36<br/>37<br/>38<br/>39<br/>40<br/>41<br/>42<br/>43<br/>44<br/>45<br/>46<br/>47<br/>48</pre></td><td class="code"><pre class="highlight"><code>/**
 * @param $http2ch          the curl connection
 * @param $http2_server     the Apple server url
 * @param $apple_cert       the path to the certificate
 * @param $app_bundle_id    the app bundle id
 * @param $message          the payload to send (JSON)
 * @param $token            the token of the device
 * @return mixed            the status code
 */
function sendHTTP2Push($http2ch, $http2_server, $apple_cert, $app_bundle_id, $message, $token) {

    // url (endpoint)
    $url = "{$http2_server}/3/device/{$token}";

    // certificate
    $cert = realpath($apple_cert);

    // headers
    $headers = array(
        "apns-topic: {$app_bundle_id}",
        "User-Agent: My Sender"
    );

    // other curl options
    curl_setopt_array($http2ch, array(
        CURLOPT_URL =&gt; $url,
        CURLOPT_PORT =&gt; 443,
        CURLOPT_HTTPHEADER =&gt; $headers,
        CURLOPT_POST =&gt; TRUE,
        CURLOPT_POSTFIELDS =&gt; $message,
        CURLOPT_RETURNTRANSFER =&gt; TRUE,
        CURLOPT_TIMEOUT =&gt; 30,
        CURLOPT_SSL_VERIFYPEER =&gt; false,
        CURLOPT_SSLCERT =&gt; $cert,
        CURLOPT_HEADER =&gt; 1
    ));

    // go...
    $result = curl_exec($http2ch);
    if ($result === FALSE) {
      throw new Exception("Curl failed: " .  curl_error($http2ch));
    }

    // get response
    $status = curl_getinfo($http2ch, CURLINFO_HTTP_CODE);

    return $status;
}
</code></pre></td></tr></tbody></table></div></div>

<h3 id="use">use</h3>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20</pre></td><td class="code"><pre class="highlight"><code>// this is only needed with php prior to 5.5.24
if (!defined('CURL_HTTP_VERSION_2_0')) {
  define('CURL_HTTP_VERSION_2_0', 3);
}
// open connection 
$http2ch = curl_init();
curl_setopt($http2ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_2_0);

// send push
$apple_cert = '/certificates/samplepush/development.pem';
$message = '{"aps":{"alert":"Hi!","sound":"default"}}';
$token = 'dbdaeae86abcde56rtyww1859fb41b2cby053ec48987847';
$http2_server = 'https://api.development.push.apple.com'; // or 'api.push.apple.com' if production
$app_bundle_id = 'it.tabasoft.samplepush';

$status = sendHTTP2Push($http2ch, $http2_server, $apple_cert, $app_bundle_id, $message, $token);
echo "Response from apple -&gt; {$status}\n";

// close connection
curl_close($http2ch);
</code></pre></td></tr></tbody></table></div></div>

<h3 id="response">response</h3>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9</pre></td><td class="code"><pre class="highlight"><code>200 Success
400 Bad request
403 There was an error with the certificate.
405 The request used a bad :method value. Only POST requests are supported.
410 The device token is no longer active for the topic.
413 The notification payload was too large.
429 The server received too many requests for the same device token.
500 Internal server error
503 The server is shutting down and unavailable.
</code></pre></td></tr></tbody></table></div></div>

<h3 id="multi-token-send">multi token send</h3>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6</pre></td><td class="code"><pre class="highlight"><code>// open connection
// send all the pushes
for ($i = 0; $i &lt; $totSends; $i++) {
   // send push
}
// close connection
</code></pre></td></tr></tbody></table></div></div>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/php/2016/10/22/PHP-http2/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/redis/2016/10/19/Redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/redis/2016/10/19/Redis/" itemprop="url">
                【redis】basic 心得
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-19T10:00:00+08:00">
                2016-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Redis" itemprop="url" rel="index">
                    <span itemprop="name">Redis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="安裝-redis">安裝 redis</h2>

<ul>
  <li>http://redis.io/</li>
  <li>下載後，執行網頁上安裝方法</li>
</ul>

<h3 id="將-redis-安裝到-usrlocalbin-的方法">將 redis 安裝到 /usr/local/bin 的方法</h3>

<ul>
  <li><code class="highlighter-rouge">make install</code>
    <ul>
      <li>更改預設安裝位置 : <code class="highlighter-rouge">make PREFIX=/some/other/directory install</code></li>
    </ul>
  </li>
  <li>此方法會安裝 binaries 到系統中，但相關的 script 與配置檔，並不會放到是到的位置，因為只是 play</li>
  <li>若需要安裝到正式的系統中，請使用
    <ul>
      <li><code class="highlighter-rouge">cd utils</code></li>
      <li><code class="highlighter-rouge">./install_server.sh</code></li>
      <li>此種安裝方式會詢問幾個設定的問題，並且在 sys reboot 後會自動重新啟動</li>
      <li>手動停止與啟動 : <code class="highlighter-rouge">/etc/init.d/redis_&lt;portnumber&gt;</code></li>
    </ul>
  </li>
</ul>

<h2 id="use">use</h2>

<ul>
  <li>啟用伺服器
    <ul>
      <li>直接啟用 : <code class="highlighter-rouge">src/redis-server</code></li>
      <li>制定設定檔 : <code class="highlighter-rouge">./src/redis-server /path/to/redis.conf</code></li>
      <li>透過指令直接覆蓋設定檔 :
        <ul>
          <li><code class="highlighter-rouge">./redis-server --port 9999 --slaveof 127.0.0.1 6379</code></li>
          <li><code class="highlighter-rouge">./redis-server /etc/redis/6379.conf --loglevel debug</code></li>
          <li>在 redis.conf 中的參數名稱，全部都支援使用 command line 進行設定。</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>啟用 client
    <ul>
      <li><code class="highlighter-rouge">src/redis-cli</code>，進入互動介面</li>
      <li>測試
        <ul>
          <li><code class="highlighter-rouge">ping</code></li>
          <li><code class="highlighter-rouge">set foo bar</code></li>
          <li><code class="highlighter-rouge">get foo</code></li>
        </ul>
      </li>
      <li>可直接下指令 <code class="highlighter-rouge">./redis_cli get foo</code> 取得參數</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">./redis_cli --help</code> : 查看一般指令</li>
  <li><code class="highlighter-rouge">./redis_cli help {cmd}</code> : 取得指令相關資訊</li>
  <li><code class="highlighter-rouge">./redis_cli command</code> : 取得全部指令</li>
</ul>

<h2 id="特性">特性</h2>

<ul>
  <li>redis 是一個 key-value 的資料庫</li>
  <li>資料結構儲存的特性
    <ul>
      <li>儲存於 disk 上，儘管修改是透過 server memory。代表 redis 是快速的，也代表儲存是持久性的。</li>
      <li>在相同的高階編程語言下，redis 的效能結構儲存，相對優秀</li>
      <li>Redis 提供很多 database 上習慣性的方法，如複製、tunable levels of durability、叢集、高度擴展</li>
    </ul>
  </li>
  <li>Redis 提供更多複雜的使用方法，在 memcached 上。</li>
  <li>more
    <ul>
      <li>Introduction to Redis data types. http://redis.io/topics/data-types-intro</li>
      <li>Try Redis directly inside your browser. http://try.redis.io</li>
      <li>The full list of Redis commands. http://redis.io/commands</li>
      <li>There is much more inside the Redis official documentation. http://redis.io/documentation</li>
    </ul>
  </li>
  <li>資料類型 : strings, arrays, integers, NULL, errors and so forth</li>
</ul>

<h2 id="測試">測試</h2>

<ul>
  <li>將 server 關閉後，依然取得到 key-value</li>
</ul>

<h2 id="redis-cli">redis-cli</h2>

<h3 id="basic">basic</h3>

<ul>
  <li>計數 : <code class="highlighter-rouge">redis-cli incr {變數名稱}</code></li>
  <li>寫入檔案 : <code class="highlighter-rouge">redis-cli incr {變數名稱} &gt; ./output.txt</code></li>
  <li>取得 : <code class="highlighter-rouge">redis-cli get {變數名稱}</code>
    <ul>
      <li>指定輸出為 raw <code class="highlighter-rouge">redis-cli --raw get {變數名稱}</code></li>
    </ul>
  </li>
  <li>刪除 :
    <ul>
      <li><code class="highlighter-rouge">./redis-cli del {變數名稱}</code></li>
      <li><code class="highlighter-rouge">./redis-cli flushall</code> : 刪除全部 keys from all db</li>
      <li><code class="highlighter-rouge">./redis-cli flushdb</code> : 從目前的 db 刪除掉所有的 keys</li>
    </ul>
  </li>
  <li>設定 : <code class="highlighter-rouge">redis-cli set {變數名稱}</code></li>
  <li>查看變數編碼屬性 : <code class="highlighter-rouge">OBJECT ENCODING {變數名稱}</code>
    <ul>
      <li>int</li>
      <li>raw</li>
      <li>embstr</li>
      <li>more : <a href="http://redisbook.com/preview/object/string.html">http://redisbook.com/preview/object/string.html</a></li>
    </ul>
  </li>
  <li>接續 : <code class="highlighter-rouge">redis-cli append {變數名稱} "{延伸內容}"</code></li>
  <li>列出所有的 {變數名稱} : <code class="highlighter-rouge">KEYS *</code>
    <ul>
      <li>列出指定內容的 {變數名稱} : <code class="highlighter-rouge">KEYS *o*</code></li>
    </ul>
  </li>
  <li>查看 {變數名稱} 是否存在 : <code class="highlighter-rouge">./redis-cli exists {變數名稱} ...</code></li>
</ul>

<h3 id="host-port-password-and-database">Host, port, password and database</h3>

<ul>
  <li>Host, port
    <ul>
      <li>預設的 ./redis-cli 設定為
        <ul>
          <li>server : 127.0.0.1</li>
          <li>port : 6379</li>
        </ul>
      </li>
      <li>specify <code class="highlighter-rouge">-h</code> &amp; <code class="highlighter-rouge">-p</code> : <code class="highlighter-rouge">./redis-cli -h redis15.localnet.org -p 6390 ping</code></li>
    </ul>
  </li>
  <li>password
    <ul>
      <li><code class="highlighter-rouge">./redis-cli a {password} ping</code></li>
    </ul>
  </li>
  <li>database
    <ul>
      <li>預設會有 16 個 db，db 的名稱是用數字表達</li>
      <li>basic
        <ul>
          <li>查詢 db 數量 : <code class="highlighter-rouge">./redis-cli CONFIG GET databases</code></li>
          <li>查詢每個 db 中的內存 : <code class="highlighter-rouge">./redis-cli INFO keyspace</code></li>
          <li>指定 db 設定參數 : <code class="highlighter-rouge">./redis-cli -n 1 set {變數名稱} {內容}</code>
            <ul>
              <li>n 預設為 0</li>
            </ul>
          </li>
          <li>顯示目前此 db 的 key 數量 : <code class="highlighter-rouge">./redis-cli dbsize</code></li>
          <li>移動 key 到另一個 db : <code class="highlighter-rouge">./redis-cli move {db_number}</code></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="special-modes-of-operation--redis-cli---help">Special modes of operation : <code class="highlighter-rouge">./redis-cli --help</code></h3>

<ul>
  <li>即時查看系統狀態 : <code class="highlighter-rouge">./redis-cli --stat</code></li>
  <li>分析 key : <code class="highlighter-rouge">redis-cli --bigkeys</code></li>
  <li>Getting a list of keys :
    <ul>
      <li><code class="highlighter-rouge">./redis-cli --scan | head -10</code></li>
      <li><code class="highlighter-rouge">./redis-cli --scan --pattern '*-11*'</code></li>
      <li><code class="highlighter-rouge">redis-cli --scan --pattern 'user:*' | wc -l</code></li>
    </ul>
  </li>
  <li>Pub/sub mode
    <ul>
      <li><code class="highlighter-rouge">publish {channel} {message}</code></li>
      <li><code class="highlighter-rouge">subscribe {channel} ...</code></li>
      <li><code class="highlighter-rouge">psubscribe {pattern}</code> : 設定 pattern 直接訂閱相關的頻道
        <ul>
          <li>pattern : <code class="highlighter-rouge">?, * , [ab]</code>
            <ul>
              <li><code class="highlighter-rouge">h?llo</code> 訂閱所有 <code class="highlighter-rouge">h?ll0</code> 相關頻道，只有一個字元</li>
              <li><code class="highlighter-rouge">h*llo</code> 訂閱所有 <code class="highlighter-rouge">h*llo</code> 相關頻道，<code class="highlighter-rouge">*</code> 可以是多個字元</li>
              <li><code class="highlighter-rouge">h[ae]llo</code> 訂閱 hallo 與 hello 頻道</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>即時監控目前 redis 所有的參數 : <code class="highlighter-rouge">./redis-cli monitor</code></li>
  <li>測試＋模擬 redis 的延遲 (以毫秒計):
    <ul>
      <li>基本 : <code class="highlighter-rouge">./redis-cli --latency -h {host} -p {port}</code>，可跨伺服器測試，預設為 localhost:6390</li>
      <li>每 15 秒 重新產生一次測試 : <code class="highlighter-rouge">./redis-cli --latency-history</code></li>
      <li>圖像化顯示 : <code class="highlighter-rouge">./redis-cli --latency-dist</code></li>
      <li>測試 redis 內部延遲，此依賴 cpu 效能
        <ul>
          <li><code class="highlighter-rouge">./redis-cli --intrinsic-latency {秒數}</code> : 在 {秒數} 內測試</li>
        </ul>
      </li>
      <li>文章
        <ul>
          <li><a href="https://read01.com/yz68z4.html">淺談 Redis 超時</a></li>
          <li><a href="https://read01.com/O3a48K.html">Redis性能調優：保存SNAPSHOT對性能的影響</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Remote backups of RDB files
    <ul>
      <li><code class="highlighter-rouge">./redis-cli --rdb /tmp/dump.rdb</code></li>
    </ul>
  </li>
  <li>透過此指令，會複製 redis 上面載入的指令，到 slave，可清楚的看到下的指令順序是否正確
    <ul>
      <li><code class="highlighter-rouge">redis-cli --slave</code></li>
    </ul>
  </li>
  <li>Performing an LRU simulation
    <ul>
      <li>使用 LRU 測試，模擬效能</li>
      <li>透過設定 memory 與測試的 keys，來觀察效率 miss 的比例</li>
      <li><a href="http://redis.io/topics/rediscli#performing-an-lru-simulation">http://redis.io/topics/rediscli#performing-an-lru-simulation</a> 此篇有測試的過程</li>
    </ul>
  </li>
</ul>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/redis/2016/10/19/Redis/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/ssh/2016/10/14/SSH-Remote-Access/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/ssh/2016/10/14/SSH-Remote-Access/" itemprop="url">
                【SSH】設定簡易遠端登入
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-14T08:01:00+08:00">
                2016-10-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/SSH" itemprop="url" rel="index">
                    <span itemprop="name">SSH</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="readme">readme</h1>

<ul>
  <li>env : osx 10.11</li>
  <li>使用 ssh 配置，便易登入遠端 server</li>
</ul>

<h1 id="sshconfig">.ssh/config</h1>

<blockquote>
  <p>所有的參數列表 https://linux.die.net/man/5/ssh_config，see PATTERNS</p>
</blockquote>

<ul>
  <li>Host  {本機辨識的名稱}</li>
  <li>HostName</li>
  <li>Port</li>
  <li>User</li>
</ul>

<h2 id="相關參數">相關參數</h2>

<ul>
  <li>Host</li>
  <li>HostNmae</li>
  <li>User</li>
  <li>Port : 連線端口</li>
  <li>DynamicForward : 本地端口</li>
</ul>

<h2 id="範例">範例</h2>

<blockquote>
  <p>登入遠端主機</p>
</blockquote>

<ol>
  <li>設定檔
    <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5</pre></td><td class="code"><pre class="highlight"><code># server
Host dev
HostName dev.max.com
Port 8888
User root
</code></pre></td></tr></tbody></table></div>    </div>
  </li>
  <li><code class="highlighter-rouge">ssh dev</code></li>
</ol>

<h2 id="金鑰">金鑰</h2>

<blockquote>
  <p>若需設定伺服器金鑰，進行遠端登入</p>
</blockquote>

<ol>
  <li>在本機端生成金鑰 <code class="highlighter-rouge">$ ssh-keygen -t rsa -b 4096 -C "your_email@example.com"</code></li>
  <li>上傳 pub_key 到伺服器端</li>
  <li>將 key 匯入 <code class="highlighter-rouge">~/.ssh/authorized_keys</code></li>
  <li><code class="highlighter-rouge">chmod 600 ~/.ssh/authorized_keys</code></li>
  <li>設定伺服器端配置，<code class="highlighter-rouge">/etc/ssh/sshd_config</code>
    <ul>
      <li>PubkeyAuthentication yes
      - PasswordAuthentication no</li>
    </ul>
  </li>
  <li>重啟 sshd 服務</li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/ssh/2016/10/14/SSH-Remote-Access/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/ssh/github/2016/10/14/SSH-Github-Account/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/ssh/github/2016/10/14/SSH-Github-Account/" itemprop="url">
                【SSH】多個 github 帳號下的 git clone
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-14T07:30:00+08:00">
                2016-10-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/SSH" itemprop="url" rel="index">
                    <span itemprop="name">SSH</span>
                  </a>
                </span>

                
                
                  , 
                
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Github" itemprop="url" rel="index">
                    <span itemprop="name">Github</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="readme">readme</h1>

<ul>
  <li>env : osx 10.11</li>
  <li>使用 github 時，根據兩個不同的帳號進行切換 ssh-key</li>
</ul>

<h1 id="產生-ssh-key">產生 ssh-key</h1>

<p><code class="highlighter-rouge">$ ssh-keygen -t rsa -b 4096 -C "your_email@example.com"</code></p>

<h1 id="sshconfig">.ssh/config</h1>

<blockquote>
  <p>所有的參數列表 <a href="https://linux.die.net/man/5/ssh_config">https://linux.die.net/man/5/ssh_config</a>，<strong>see PATTERNS</strong></p>
</blockquote>

<ul>
  <li>Host {本機辨識的名稱}</li>
  <li>HostName 主機位置</li>
  <li>User 登入帳號</li>
  <li>IdentityFile 憑證位置</li>
</ul>

<h2 id="參數">參數</h2>

<ul>
  <li>Host : 此為此組 ssh 的名稱，讓本機辨識專用，故可任意取名，當 <code class="highlighter-rouge">git clone git@{Host}:{your_group_name}/{project}.git</code> 則會依照 {Host} 取得相關 key</li>
  <li>HostName : github.com</li>
  <li>User : git</li>
  <li>IdentityFile : 此為 ssh private key 存放位置</li>
</ul>

<h1 id="範例">範例</h1>

<blockquote>
  <p>有兩個不同帳號，user_A &amp; user_B</p>
</blockquote>

<ol>
  <li>產生 key</li>
  <li>設定 config
    <ul>
      <li>user_A
        <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5</pre></td><td class="code"><pre class="highlight"><code># user_A@gmail.com
Host gitlab.com-user_A
HostName github.com
User git
IdentityFile ~/.ssh/user_A/id_rsa
</code></pre></td></tr></tbody></table></div>        </div>
      </li>
      <li>user_B
        <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5</pre></td><td class="code"><pre class="highlight"><code># user_B@gmail.com
Host gitlab.com-user_B
HostName github.com
User git
IdentityFile ~/.ssh/user_B/id_rsa
</code></pre></td></tr></tbody></table></div>        </div>
      </li>
    </ul>
  </li>
  <li>使用，將原本的 <code class="highlighter-rouge">git@github.com:jhaoheng/APNS_cer_build.git</code> ，github 的部分，改為 Host 的參數名稱
    <ul>
      <li>ex : <code class="highlighter-rouge">git clone git@github.com-user_A:jhaoheng/APNS_cer_build.git</code></li>
    </ul>
  </li>
  <li>注意上傳的 name 與 email
    <ul>
      <li>使用 <code class="highlighter-rouge">git config --local -l</code> : 查看目前該 git repo 的基本設定
        <ul>
          <li>可用 <code class="highlighter-rouge">git config --local user.name</code> 與 <code class="highlighter-rouge">git config --local user.email</code> 設定</li>
        </ul>
      </li>
    </ul>
  </li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/ssh/github/2016/10/14/SSH-Github-Account/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/2016/10/01/docgenerate-program-converting-comments-help-file/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/2016/10/01/docgenerate-program-converting-comments-help-file/" itemprop="url">
                【docGenerate】程式註解轉換成說明檔
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-01T03:10:00+08:00">
                2016-10-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="source">source</h2>

<p>https://github.com/jhaoheng/docGenerate/tree/master</p>

<h2 id="使用環境">使用環境</h2>

<ul>
  <li>v0.1-release : 單純支援bash script 的環境</li>
  <li>v0.2-release : 支援 config.json (需安裝 jq)</li>
</ul>

<h2 id="目的">目的</h2>

<p>不論是寫何種語言，都希望能把當下程式中的註解，直接轉譯為 .md，並且能最小化註解風格格式化
方便性為，若為 restful-api 對外的文件，則可直接將要公開的文件內容輸出為 .md 檔案
降低文件的重複編輯性，加速工程人員對於文件註解的習慣與完整性</p>

<p>Hope this script could help accelerate development and persist in good comment habit.
Do not need to maintain twice version between code and document.
When developer write down comment in code context, it mean that you finish the document at the same time.</p>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/2016/10/01/docgenerate-program-converting-comments-help-file/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/2016/09/30/phalcon-modelsqlstatehy000-2002/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/2016/09/30/phalcon-modelsqlstatehy000-2002/" itemprop="url">
                【phalcon model】SQLSTATE[HY000] [2002]
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-09-30T03:06:00+08:00">
                2016-09-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="env">env</h2>

<ul>
  <li>phalcon DevTools (3.0.1)</li>
  <li>MAMP 3.5.2
    <ul>
      <li>php 7.0.8</li>
      <li>mysql</li>
    </ul>
  </li>
</ul>

<h2 id="trouble">Trouble</h2>

<ul>
  <li>cmd : <code class="highlighter-rouge">phalcon model --name [table_name]</code></li>
  <li>error : <code class="highlighter-rouge">ERROR: SQLSTATE[HY000] [2002] No such file or directory</code></li>
</ul>

<h2 id="fix">Fix</h2>

<p>Because the phalcon-DevTools [php version] does not set MAMP mysql source</p>

<p>use</p>

<ul>
  <li><code class="highlighter-rouge">php -ini</code></li>
  <li><code class="highlighter-rouge">vim php.ini</code></li>
  <li>search <code class="highlighter-rouge">mysql.default_socket</code> 填入 <code class="highlighter-rouge">/Applications/MAMP/tmp/mysql/mysql.sock</code>
    <ul>
      <li><code class="highlighter-rouge">pdo_mysql.default_socket = /Applications/MAMP/tmp/mysql/mysql.sock</code></li>
    </ul>
  </li>
  <li>restart MAMP</li>
</ul>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/2016/09/30/phalcon-modelsqlstatehy000-2002/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/2016/09/20/projectnotification-package/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/2016/09/20/projectnotification-package/" itemprop="url">
                【Project】iOS Notification Package
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-09-20T14:59:00+08:00">
                2016-09-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="目的">目的</h2>

<p>每次處理 apns，總是會發生很多意外，token 錯誤，憑證搞錯….
此兩個 app，主要就是在解決測試環境的問題</p>

<h2 id="application">application</h2>

<ul>
  <li><a href="https://github.com/jhaoheng/APNS_cer_build">APNS_cer_build</a>
    <ul>
      <li>收納憑證
        <ul>
          <li>建立憑證</li>
          <li>測試憑證</li>
          <li>測試 apns server</li>
          <li>測試推播</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="https://github.com/jhaoheng/apnsReceiver">apnsReceiver</a>
    <ul>
      <li>查看目前 ipa 的版本為
        <ul>
          <li>developement</li>
          <li>Ad-Hoc</li>
          <li>App Store</li>
          <li>Enterprise</li>
        </ul>
      </li>
      <li>查看 token</li>
      <li>寄送 token</li>
      <li>接收 push</li>
    </ul>
  </li>
</ul>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/2016/09/20/projectnotification-package/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/ios/ipa/2016/09/20/iOS-ipa/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/ios/ipa/2016/09/20/iOS-ipa/" itemprop="url">
                【ipa】check Provision
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-09-20T14:38:00+08:00">
                2016-09-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/iOS" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
                  , 
                
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/ipa" itemprop="url" rel="index">
                    <span itemprop="name">ipa</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="手動檢查">手動檢查</h2>

<ol>
  <li>將輸出的 .ipa，改為 .zip，解壓縮。</li>
  <li>開啟 Terminal 並移動到該 解壓縮後的 Payload 中，會看到 embedded.mobileprovision</li>
  <li><code class="highlighter-rouge">security cms -D -i embedded.mobileprovision</code></li>
  <li>解析結構就可發現不同點</li>
</ol>

<h2 id="code">code</h2>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35</pre></td><td class="code"><pre class="highlight"><code>NSData *provisioningProfile = nil;
NSData *raw = [NSData dataWithContentsOfURL:[NSBundle.mainBundle URLForResource:@"embedded" withExtension:@"mobileprovision"]];
char *start = memmem(raw.bytes,
                     raw.length,
                     "&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0",
                     47);
if (start) {
    char *end = memmem(start,
                       (uintptr_t)start - raw.length,
                       "&lt;/plist&gt;",
                       8);
    if (end) {
        provisioningProfile = [NSData dataWithBytes:start length:8 + end - start];
    }
}

if (provisioningProfile) {
    NSDictionary* plist = [NSPropertyListSerialization propertyListWithData:provisioningProfile
                                                                    options:NSPropertyListImmutable
                                                                     format:0
                                                                      error:0];
    NSLog(@"\n\n\nTeam name: %@", plist[@"TeamName"]);

    if ([plist[@"ProvisionsAllDevices"] boolValue]) {
        NSLog(@"Enterprise");
    } else if ([plist[@"ProvisionedDevices"] count] &gt; 0) {
        if ([plist[@"Entitlements"][@"get-task-allow"] boolValue]) {
            NSLog(@"Development");
        } else {
            NSLog(@"Ad Hoc");
        }
    } else {
        NSLog(@"App Store");
    }
}
</code></pre></td></tr></tbody></table></div></div>

<h2 id="分析結構">分析結構</h2>

<h3 id="dev">Dev</h3>

<p>若是 <code class="highlighter-rouge">Dev</code> build app，會看到</p>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2</pre></td><td class="code"><pre class="highlight"><code>&lt;key&gt;get-task-allow&lt;/key&gt;
&lt;true/&gt;
</code></pre></td></tr></tbody></table></div></div>

<h3 id="ad-hoc">Ad-Hoc</h3>

<p>若是 <code class="highlighter-rouge">Ad-Hoc</code></p>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2</pre></td><td class="code"><pre class="highlight"><code>&lt;key&gt;get-task-allow&lt;/key&gt;
&lt;false/&gt;
</code></pre></td></tr></tbody></table></div></div>
<p>且</p>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6</pre></td><td class="code"><pre class="highlight"><code>&lt;key&gt;ProvisionedDevices&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;abcdef01234567890abcdef01234567890abacde&lt;/string&gt;
    &lt;string&gt;1abcdef01234567890abcdef01234567890abacd&lt;/string&gt;
    &lt;string&gt;2abcdef01234567890abcdef01234567890abacd&lt;/string&gt;
&lt;/array&gt;
</code></pre></td></tr></tbody></table></div></div>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/ios/ipa/2016/09/20/iOS-ipa/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/2016/09/07/mqttlogin-mqtt8883-ssl-tls-with-certificate-authority-ca/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/2016/09/07/mqttlogin-mqtt8883-ssl-tls-with-certificate-authority-ca/" itemprop="url">
                【MQTT】Login mqtt:8883 SSL/TLS with certificate authority (CA)
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-09-07T02:01:00+08:00">
                2016-09-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="login-mqtt8883-ssltls-certificate-authority-ca">login mqtt:8883 SSL/TLS (certificate authority (CA))</h1>

<ul>
  <li><a href="https://github.com/jhaoheng/emqttd_test">github</a></li>
</ul>

<h2 id="required-file">required file</h2>

<p>use below file and cmd[mosquitto_sub] to connect MQTT:8883</p>

<ul>
  <li>ca.crt – The CA (Certificate Authority, who published the host certificate) public certificate.</li>
  <li>ssl.crt – The hostname, public certificate.</li>
  <li>ssl.key – The hostname, private key.</li>
</ul>

<h2 id="generate_1--use-generate-cash-to-generate">Generate_1 : use <strong>generate-CA.sh</strong> to generate</h2>

<ol>
  <li>Download generate-CA.sh and create local server CA, and will generate….
    <ul>
      <li>ca.srl / ca.crt / ca.key</li>
      <li>xxx is local server name, xxx.crt / xxx.csr / xxx.key</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">cp xxx.crt ssl.crt</code> and <code class="highlighter-rouge">cp xxx.key ssl.key</code></li>
</ol>

<h2 id="generate_2--use-cmd-openssl-to-generate">Generate_2 : use cmd [openssl] to generate</h2>

<ol>
  <li>Generate ca.crt and ca.key
    <ul>
      <li><code class="highlighter-rouge">openssl req -newkey rsa:2048 -x509 -nodes -sha512 -days 365 -extensions v3_ca -keyout ca.key -out ca.crt</code></li>
      <li>check : <code class="highlighter-rouge">openssl x509 -in ca.crt -nameopt multiline -subject -noout</code></li>
    </ul>
  </li>
  <li>Generate server.key
    <ul>
      <li><code class="highlighter-rouge">openssl genrsa -out server.key 2048</code></li>
    </ul>
  </li>
  <li>Generate server.csr
    <ul>
      <li><code class="highlighter-rouge">openssl req -new -sha512 -out server.csr -key server.key</code></li>
    </ul>
  </li>
  <li>Generate server.crt by server.csr, ca.crt, cae.key, ca.srl
    <ul>
      <li><code class="highlighter-rouge">openssl x509 -req -sha512 -in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial -CAserial ca.srl -out server.crt -days 365 -extensions JPMextensions</code></li>
      <li>check : <code class="highlighter-rouge">openssl x509 -in server.crt -nameopt multiline -subject -noout</code></li>
    </ul>
  </li>
</ol>

<p>note : <code class="highlighter-rouge">ca.crt</code> and <code class="highlighter-rouge">server.crt</code>, their <code class="highlighter-rouge">commonName</code> should not be the same.</p>

<h2 id="verify-check-servercrt-is-generated-by-cacrt">Verify: check server.crt is generated by ca.crt</h2>

<ul>
  <li><code class="highlighter-rouge">openssl verify -CAfile ca.crt server.crt</code>
    <ul>
      <li>output ssl.crt: OK</li>
    </ul>
  </li>
</ul>

<h2 id="test">Test</h2>

<ol>
  <li><code class="highlighter-rouge">mv ssl* to /emqttd/etc/ssl/</code></li>
  <li>Test : <code class="highlighter-rouge">mosquitto_sub -h [server_ip] -p 8883 -t [topic] -i [clientId] -u [username] -P [password] --cafile ca.crt</code>
    <ul>
      <li>Notice where is your <code class="highlighter-rouge">ca.crt</code> file</li>
    </ul>
  </li>
  <li>go to your emqttd console, emqttd:18083, and watch Clients</li>
</ol>

<h2 id="ex--servercrt">ex : server.crt</h2>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8</pre></td><td class="code"><pre class="highlight"><code>subject= 
    countryName               = TW
    stateOrProvinceName       = TAIWAN
    localityName              = TAIPEI
    organizationName          = COMPANY
    organizationalUnitName    = DEV
    commonName                = dev-mqtt.com
    emailAddress              = max.hu@mail
</code></pre></td></tr></tbody></table></div></div>

<h2 id="ex--cacrt">ex : ca.crt</h2>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5</pre></td><td class="code"><pre class="highlight"><code>subject= 
    commonName                = An MQTT broker
    organizationName          = COMPANY
    organizationalUnitName    = DEV
    emailAddress              = max.hu@mail
</code></pre></td></tr></tbody></table></div></div>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/2016/09/07/mqttlogin-mqtt8883-ssl-tls-with-certificate-authority-ca/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/xcode/2016/08/31/xcode-macros-scheme/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/xcode/2016/08/31/xcode-macros-scheme/" itemprop="url">
                【xcode】Configurations/ Preprocessor Macros/ scheme
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-31T06:26:00+08:00">
                2016-08-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Xcode" itemprop="url" rel="index">
                    <span itemprop="name">Xcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="why">why</h1>

<p>In dev / release env, switch the default global variable :</p>
<ul>
  <li>url</li>
  <li>other env variable</li>
</ul>

<h1 id="xcode-setting">xcode setting</h1>

<ol>
  <li>PROJECT -&gt; info -&gt; Configurations，default only have “Debug” &amp; “Release” tag
    <ul>
      <li>Use scheme to switch the tag</li>
    </ul>
  </li>
  <li>goto Targets，choose the “Macros” from target
    <ul>
      <li>Build Setting -&gt; Preprocessor Macros, you can find “Debug” &amp; “Release” tag</li>
      <li>In Macros, set your tag &amp; value</li>
    </ul>
  </li>
</ol>

<h1 id="scheme-switch">scheme switch</h1>

<p>Debug &amp; Realese tags are set by xcode Configuration</p>

<ol>
  <li>edit scheme.</li>
  <li>select Run tag, switch the “Build Configuration” tag to change your build setting.</li>
</ol>

<h1 id="coding-example">coding example</h1>

<p>you can create a config.h or .pch to set your info.</p>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7</pre></td><td class="code"><pre class="highlight"><code>#if DEBUG
#define a symbol
#elseif RELEASE
#define a symbol
#else
#define a symbol
#endif
</code></pre></td></tr></tbody></table></div></div>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5</pre></td><td class="code"><pre class="highlight"><code>#if DEBUG==1
#define debug_only YES
#else
#define debug_only NO
#endif
</code></pre></td></tr></tbody></table></div></div>

<p>Notice <code class="highlighter-rouge">#if</code> and <code class="highlighter-rouge">#ifdef</code> is diff.</p>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/xcode/2016/08/31/xcode-macros-scheme/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
      
    </footer>
  </article>

  
</section>


  <nav class="pagination">
    
    
    



    <a class="extend prev" rel="prev" href="/blogpost/page6"><i class="fa fa-angle-left"></i></a> <a class="page-number" href="/blogpost/">1</a> <span class="space">&hellip;</span> <a class="page-number" href="/blogpost/page6">6</a> <span class="page-number current">7</span> <a class="page-number" href="/blogpost/page8">8</a> <span class="space">&hellip;</span> <a class="page-number" href="/blogpost/page11">11</a> <a class="extend prev" rel="next" href="/blogpost/page8"><i class="fa fa-angle-right"></i></a>
  </nav>




          </div>
          


          

        </div>
        
          

  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/blogpost/assets/images/avatar.gif"
               alt="Max Hu" />
          <p class="site-author-name" itemprop="name">Max Hu</p>
           
              <p class="site-description motion-element" itemprop="description">Welcome!</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/blogpost/archives/">
                <span class="site-state-item-count">103</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/blogpost/categories/">
                <span class="site-state-item-count">71</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/blogpost/tags/">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
        
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>

        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Max Hu</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





















  
   
  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/jquery/index.js?v=2.1.3"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/blogpost/assets/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/blogpost/assets/js/src/motion.js?v=5.1.1"></script>



  
  

  <script type="text/javascript" src="/blogpost/assets/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/blogpost/assets/js/src/post-details.js?v=5.1.1"></script>


  


  <script type="text/javascript" src="/blogpost/assets/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  











  




  

    

  







  






  

  

  
  


  

  

  

</body>
</html>

