
<!doctype html>














<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/blogpost/assets/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/blogpost/assets/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blogpost/assets/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="jhaoheng, maxhu, golang, objective-c" />








  <link rel="shortcut icon" type="image/x-icon" href="/blogpost/assets/favicon.ico?v=5.1.1" />
















<meta name="description" content="Welcome!">
<meta name="keywords" content="jhaoheng, maxhu, golang, objective-c">
<meta property="og:type" content="website">
<meta property="og:title" content="MAX 呼~">
<meta property="og:url" content="https://jhaoheng.github.io/blogpost/blogpost/page7/">
<meta property="og:site_name" content="MAX 呼~">
<meta property="og:description" content="Welcome!">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MAX 呼~">
<meta name="twitter:description" content="Welcome!">


<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blogpost',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"hide","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://jhaoheng.github.io/blogpost/blogpost"/>





  <title>MAX 呼~</title>
  
















</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  

  <div class="container sidebar-position-left page-home ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blogpost/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">MAX 呼~</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Spare No Effort, Leave No Regret</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
        
        <li class="menu-item menu-item-home">
          <a href="/blogpost/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-archives">
          <a href="/blogpost/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-tags">
          <a href="/blogpost/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            



<section id="posts" class="posts-expand">
  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/php/2017/01/15/PHP-Memcached/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar3.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/php/2017/01/15/PHP-Memcached/" itemprop="url">
                【php】memcached
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-15T15:24:00+08:00">
                2017-01-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/PHP" itemprop="url" rel="index">
                    <span itemprop="name">PHP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="env">ENV</h1>
<ul>
  <li>php 7.x</li>
  <li>mac osx</li>
</ul>

<h1 id="編譯好的-memcacheso">編譯好的 memcache.so</h1>
<ul>
  <li>github : https://github.com/majksner/php-memcached-mamp</li>
</ul>

<ol>
  <li>下載 memcached.so</li>
  <li>brew install memcached</li>
  <li>brew install libmemcached</li>
  <li>php –ini</li>
  <li>vim php.ini</li>
  <li>extension=memcached.so</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>php -i</td>
          <td>grep memcached</td>
        </tr>
      </tbody>
    </table>
  </li>
</ol>

<h1 id="自己-compile">自己 compile</h1>

<ul>
  <li>git clone https://github.com/php-memcached-dev/php-memcached.git</li>
</ul>

<ol>
  <li>brew install memcached</li>
  <li>brew install libmemcached</li>
  <li>git checkout php7</li>
  <li>phpize</li>
  <li><code class="highlighter-rouge">./configure --with-memcached=/usr/local/Cellar/libmemcached/1.0.18_1/lib/libmemcached</code>
    <ul>
      <li>Notice : the <code class="highlighter-rouge">libmemcached</code> path is brew install path</li>
    </ul>
  </li>
  <li>make</li>
  <li>sudo make install</li>
  <li>mv memcached.so to extension path, you could get path with <code class="highlighter-rouge">php -i | grep extension_dir</code></li>
  <li>vim php.ini, add <code class="highlighter-rouge">extension=memcached.so</code></li>
</ol>

<h1 id="如何使用">如何使用</h1>

<h2 id="前提">前提</h2>
<ol>
  <li>安裝好 memcached 在電腦中 : brew install memcached
    <ul>
      <li>至於 libmemcached 則為編譯成 .so 時使用</li>
    </ul>
  </li>
  <li>執行 memcached 即可
    <ul>
      <li><code class="highlighter-rouge">man memcached</code>
      - <code class="highlighter-rouge">memcached -l 127.0.0.1 -P 11211 -m 128 -d</code> : for deamon
      - <code class="highlighter-rouge">memcached -l 127.0.0.1 -P 11211 -m 128 -vv</code> : for debug</li>
    </ul>
  </li>
  <li>檢查 memcached 是否有執行 : <code class="highlighter-rouge">ps aux | grep memcached</code></li>
</ol>

<h2 id="判斷-php-是否安裝好支援的-memcachedso">判斷 php 是否安裝好支援的 memcached.so</h2>

<table>
  <tbody>
    <tr>
      <td>php -i</td>
      <td>grep memcached</td>
    </tr>
    <tr>
      <td>php -m</td>
      <td>grep memcached</td>
    </tr>
  </tbody>
</table>

<h2 id="test">test</h2>
<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10</pre></td><td class="code"><pre class="highlight"><code>&lt;? php
$mem  = new Memcached();

$mem-&gt;addServer('localhost',11211);
if( $mem-&gt;add("key","value",3600)){
    echo  'cached!';
}else{
    echo 'cached data：'.$mem-&gt;get("key");
}
?&gt;
</code></pre></td></tr></tbody></table></div></div>

<h2 id="console-admin">console admin</h2>

<p><code class="highlighter-rouge">git@github.com:jhaoheng/phpmemcacheadmin.git</code></p>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/php/2017/01/15/PHP-Memcached/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/php/mqtt/2017/01/12/PHP-MQTT/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar3.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/php/mqtt/2017/01/12/PHP-MQTT/" itemprop="url">
                【php+mqtt】basic
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-12T09:34:00+08:00">
                2017-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/PHP" itemprop="url" rel="index">
                    <span itemprop="name">PHP</span>
                  </a>
                </span>

                
                
                  , 
                
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/MQTT" itemprop="url" rel="index">
                    <span itemprop="name">MQTT</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="php-透過-mqtt-進行發送與監聽">php 透過 mqtt 進行發送與監聽</h1>
<h2 id="install">install</h2>

<ol>
  <li>env : mac osx, php 7.0.8</li>
  <li>確定已安裝 mosquitto 在 mac 中 : brew install mosquitto
    <ul>
      <li>取得 path : /usr/local/Cellar/mosquitto/1.4.9/lib/libmosquitto</li>
    </ul>
  </li>
  <li>下載 github : https://github.com/mgdm/Mosquitto-PHP</li>
  <li>產生 mosquitto.so
    <ol>
      <li><code class="highlighter-rouge">cd Mosquitto-PHP</code></li>
      <li><code class="highlighter-rouge">phpize</code></li>
      <li><code class="highlighter-rouge">./configure --with-mosquitto=/usr/local/Cellar/mosquitto/1.4.9/lib/libmosquitto</code></li>
      <li>make</li>
      <li>sudo make install</li>
      <li>得到 mosquitto.so 安裝的位置</li>
    </ol>
  </li>
  <li>開啟 php.ini，設定 extension=mosquitto.so 與驗證
    <ul>
      <li>MAMP，請用套件管理 php.ini
        <ul>
          <li>用 <code class="highlighter-rouge">phpinfo();</code></li>
        </ul>
      </li>
      <li>手動
        <ol>
          <li><code class="highlighter-rouge">php --ini</code></li>
          <li><code class="highlighter-rouge">cat {path}/php.ini | grep extension_dir</code></li>
          <li>將 mosquitto.so 放入此路徑</li>
          <li>在 php.ini 中設定 extension=mosquitto.so</li>
          <li>驗證 <code class="highlighter-rouge">php -i | grep mosquitto</code></li>
        </ol>
      </li>
    </ul>
  </li>
</ol>

<h2 id="測試">測試</h2>

<ul>
  <li>https://github.com/mqtt/mqtt.github.io/wiki/mosquitto-php</li>
</ul>

<h2 id="問題">問題</h2>

<ol>
  <li>訂閱問題
    <ol>
      <li>若針對所有的 topic 進行訂閱，則開兩台 instance，就會收到兩次，無法做 loading balance….所以還是分段訂閱會比較清楚</li>
      <li>當有新的必須訂閱的事件進來…就產生一個新的監聽 client(php sub.php topic)，訂閱的 topic 寫到 json 中。(or mongodb)</li>
      <li>若取消該訂閱，則從 json 中移除該 topic</li>
      <li>判斷 process 的狀態，bash file + crontab，定時檢查掛載上去的 sub topic process 與 json file 是否一致</li>
    </ol>
  </li>
  <li>用 php or cmd:mosquitto?
    <ul>
      <li>優點在 今天 sub 進來，直接處理，不用在 bash 這邊取得監聽內容後，丟給 php 處理</li>
    </ul>
  </li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/php/mqtt/2017/01/12/PHP-MQTT/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/2017/01/04/line-flash-back-fix-201701/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar3.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/2017/01/04/line-flash-back-fix-201701/" itemprop="url">
                【line】閃退，修復
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-04T13:54:00+08:00">
                2017-01-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <ul>
  <li>嘗試網路上的許多操作方法包含
    <ul>
      <li>關閉 app 後，重新開啟 (失敗)</li>
      <li>開啟飛航模式，開啟 app 後，任意傳訊息給任一人，關閉飛航模式 (失敗)</li>
      <li>重新安裝 app (失敗)</li>
      <li>透過另一支手機撥 line 電話給該 app (失敗)</li>
    </ul>
  </li>
  <li>猜測是 資料庫問題，可能為轉移資料時，產生的問題
    <ul>
      <li>飛航模式可開啟，代表 app 沒問題，可能是網路問題</li>
      <li>此手機的 line 登入另一個帳號，正常可使用，故非此 app or ios 版本的問題</li>
      <li>猜測是資料庫中的帳號，認為此手機為非該用戶，故故意不讓使用</li>
    </ul>
  </li>
  <li>解決方法
    <ol>
      <li>找出另一支手機，登入該帳號，目的在於重新設定此帳號對於 mobile 的認證</li>
      <li>進入 line 中，開啟轉移</li>
      <li>拿出原本的手機，登入帳號，即可正常使用</li>
    </ol>
  </li>
</ul>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/2017/01/04/line-flash-back-fix-201701/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/php/2017/01/04/PHP-extension/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar3.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/php/2017/01/04/PHP-extension/" itemprop="url">
                【php 7.x】/private/tmp/pear/install/yaml/php_yaml.h:56:10: fatal error: 'ext/standard/php_smart_str.h' file not found
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-04T09:40:00+08:00">
                2017-01-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/PHP" itemprop="url" rel="index">
                    <span itemprop="name">PHP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="install-ymalso">install ymal.so</h2>

<p><code class="highlighter-rouge">sudo pecl insatll yaml</code>
<strong>install Error</strong>
<code class="highlighter-rouge">/private/tmp/pear/install/yaml/php_yaml.h:56:10: fatal error: 'ext/standard/php_smart_str.h' file not found</code></p>

<h2 id="fixed">fixed</h2>

<ol>
  <li><code class="highlighter-rouge">sudo pecl install yaml-2.0.0</code></li>
  <li>add yaml.so to php.ini extension
    <ul>
      <li>use MAMP
  	1. mv yaml.so to <code class="highlighter-rouge">/Applications/MAMP/bin/php/php7.0.8/lib/php/extensions/no-debug-non-zts-xxxxxxxxxx</code>
        <ol>
          <li>edit php.ini of php7.0.8
            <ul>
              <li>others : <code class="highlighter-rouge">echo "extension=yaml.so" &gt; /usr/local/etc/php/conf.d/ext-yaml.ini</code></li>
            </ul>
          </li>
        </ol>
      </li>
    </ul>
  </li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/php/2017/01/04/PHP-extension/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/2016/11/16/erlangsplit-from-str/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar3.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/2016/11/16/erlangsplit-from-str/" itemprop="url">
                【erlang】split from str
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-16T08:11:00+08:00">
                2016-11-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18</pre></td><td class="code"><pre class="highlight"><code>-module(split).

-compile(export_all).

foo() -&gt; 
	Topic = "/a/b/c/d/e/f/g/h",
	Test = splitTopic(Topic),
	io:format("===&gt;final company is : ~p~n",[Test]).

splitTopic(Topic) -&gt; 
    Keys = string:tokens(Topic, "/"),
    [Company, Dtype, Etype, Sid | Others] = Keys,
    io:format("~n~n===Split Topic===~n"),
    io:format("- Company = ~p~n- DeviceType = ~p~n- Event_type = ~p~n- Sid = ~p~n- Others = ~p~n~n", [Company, Dtype, Etype, Sid, Others]),
    rsplit(Company).

rsplit(Company) -&gt; 
    Company.
</code></pre></td></tr></tbody></table></div></div>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/2016/11/16/erlangsplit-from-str/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/2016/11/10/erlanghello-erlang/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar3.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/2016/11/10/erlanghello-erlang/" itemprop="url">
                【erlang】Hello Erlang!
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-10T22:59:00+08:00">
                2016-11-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="hello_erlang_1">hello_erlang_1</h1>

<ul>
  <li>hello.erl
    <ul>
      <li>code
        <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4</pre></td><td class="code"><pre class="highlight"><code>-module(hello).
-export([print/0]).
print() -&gt; 
io:format("World!~n").
</code></pre></td></tr></tbody></table></div>        </div>
      </li>
      <li>解析
        <ul>
          <li><code class="highlighter-rouge">-module</code></li>
          <li><code class="highlighter-rouge">-export</code></li>
          <li><code class="highlighter-rouge">[print/0]</code> : 函數名稱 print , 參數 0 個</li>
          <li><code class="highlighter-rouge">io:format</code> : 格式化標準輸出函數，參考 <a href="http://erlang.org/doc/man/io.html#fread-2">io : Available control sequences:</a>
            <ul>
              <li><code class="highlighter-rouge">~n</code> : Writes a new line.</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>test
    <ul>
      <li>流程
        <ol>
          <li><code class="highlighter-rouge">erl</code></li>
          <li><code class="highlighter-rouge">pwd().</code></li>
          <li><code class="highlighter-rouge">ls().</code></li>
          <li><code class="highlighter-rouge">c(hello).</code> : hello 為 hello.erl 的檔案名稱, c() 為編譯此檔案 -&gt; 會產生 hello.beam 的執行擋</li>
          <li><code class="highlighter-rouge">hello:print().</code></li>
        </ol>
      </li>
      <li>基本
        <ul>
          <li><code class="highlighter-rouge">.</code> : 每一句皆以此，作為一個斷句</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="hello_erlang_2">hello_erlang_2</h1>

<ul>
  <li>hello2.erl
    <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7</pre></td><td class="code"><pre class="highlight"><code>-module(hello2).
-compile(export_all).
square(N) -&gt; N*N.
sum([]) -&gt; 0;
sum([Num|Ns]) -&gt; Num + sum(Ns).
sum_square([]) -&gt; 0;
sum_square([Num|Ns]) -&gt; square(Num) + sum_square(Ns).
</code></pre></td></tr></tbody></table></div>    </div>
  </li>
  <li>test
    <ul>
      <li><code class="highlighter-rouge">hello2:square(2).</code> : 4</li>
      <li><code class="highlighter-rouge">hello2:sum([1,2,3,4,5]).</code> : 15</li>
      <li><code class="highlighter-rouge">;</code> : 代表 or</li>
      <li><code class="highlighter-rouge">,</code> : 代表 and</li>
    </ul>
  </li>
</ul>

<h1 id="hello_erlang_3">hello_erlang_3</h1>

<ul>
  <li>hello3.erl
    <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4</pre></td><td class="code"><pre class="highlight"><code>solve(1) -&gt; [1];
solve(N) when N rem 2 == 0 -&gt; [N|solve(N div 2)];
solve(N) -&gt; [N|solve(N*3+1)].
set(N) 	-&gt; {ok, [H|T] = solve(N)}.
</code></pre></td></tr></tbody></table></div>    </div>
  </li>
</ul>

<h1 id="hello_erlang_4--regular-expressions">hello_erlang_4 : regular expressions</h1>

<ul>
  <li>hello4.erl
```
-module(do).
-compile(export_all).</li>
</ul>

<p>multire([],_) -&gt;
    nomatch;
multire([RE|RegExps],String) -&gt;
    case re:run(String,RE,[{capture,none}]) of
    match -&gt;
        RE;
    nomatch -&gt;
        multire(RegExps,String)
    end.</p>

<p>% 開頭為 Hello, 結尾有 world, 均符合
test(Foo) -&gt;
    test2(multire([“^Hello”,”world$”,”^….$”],Foo),Foo).</p>

<p>test2(“^Hello”,Foo) -&gt;
    io:format(“~p matched the hello pattern~n”,[Foo]);
test2(“world$”,Foo) -&gt;
    io:format(“~p matched the world pattern~n”,[Foo]);
test2(“^….$”,Foo) -&gt;
    io:format(“~p matched the four chars pattern~n”,[Foo]);
test2(nomatch,Foo) -&gt;
    io:format(“~p failed to match~n”,[Foo]).</p>

<p>-define (Email_pattern, “\b[a-zA-Z0-9.!#$%&amp;’<em>+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)</em>\b”).
-define (Mac_address_pattern, “^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$”).</p>

<p>checkPattern(Foo) -&gt; 
  checkPattern2(multire([[?Email_pattern], [?Mac_address_pattern]],Foo),Foo).</p>

<p>checkPattern2([?Email_pattern], Foo) -&gt;
  io:format(“email format : ~p ~n”, [Foo]);
checkPattern2([?Mac_address_pattern], Foo) -&gt;
  io:format(“device format : ~p ~n”, [Foo]);
checkPattern2(nomatch, Foo) -&gt;
  io:format(“nomatch : ~p ~n”, [Foo]).
```</p>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/2016/11/10/erlanghello-erlang/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/2016/10/24/gclouddocker-push-pull-delete/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar3.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/2016/10/24/gclouddocker-push-pull-delete/" itemprop="url">
                【gcloud】docker push/pull/delete
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-24T10:01:00+08:00">
                2016-10-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="basic">basic</h2>
<ol>
  <li>先 login gcloud</li>
  <li>安裝 docker</li>
</ol>

<h2 id="push-to-registry">push to registry</h2>

<ol>
  <li>檢查目前 images : <code class="highlighter-rouge">docker images</code></li>
  <li>對要上傳的 image 設定 tag : <code class="highlighter-rouge">docker tag [image_id] [location]/[project_id]/[image_name]</code>
    <ul>
      <li><code class="highlighter-rouge">[location]</code> : [‘gcr.io’, ‘us.gcr.io’, ‘eu.gcr.io’, ‘asia.gcr.io’, ‘b.gcr.io’, ‘bucket.gcr.io’, ‘appengine.gcr.io’, ‘gcr.kubernetes.io’]</li>
    </ul>
  </li>
  <li>檢查 <code class="highlighter-rouge">docker images</code> 會發現多了一個 images</li>
  <li>push : <code class="highlighter-rouge">gcloud docker push [location]/[project_id]/[image_name]</code></li>
</ol>

<h2 id="移除掉-image_id-locationproject_idimage_name">移除掉 [image_id] [location]/[project_id]/[image_name]</h2>

<ol>
  <li>本機 : <code class="highlighter-rouge">docker rmi [image_id] [location]/[project_id]/[image_name]</code></li>
  <li>gcloud : 可直接到 consonle 的 registry 中，進入 image，將該版本刪除</li>
</ol>

<h2 id="pull">pull</h2>

<ol>
  <li>登入 console</li>
  <li>進入 registry</li>
  <li>選擇 images，取得 pull 指令</li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/2016/10/24/gclouddocker-push-pull-delete/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/php/2016/10/22/PHP-http2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar3.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/php/2016/10/22/PHP-http2/" itemprop="url">
                【PHP】push with http2
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-22T17:05:00+08:00">
                2016-10-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/PHP" itemprop="url" rel="index">
                    <span itemprop="name">PHP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="env">env</h2>

<p>mac, osx , 10.11</p>

<h2 id="config">config</h2>

<ul>
  <li><code class="highlighter-rouge">php -i</code> , check config :
    <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7</pre></td><td class="code"><pre class="highlight"><code>[curl]
cURL support =&gt; enabled
cURL Information =&gt; 7.47.1
...
HTTP2 =&gt; Yes
...
SSL Version =&gt; OpenSSL/1.0.2g
</code></pre></td></tr></tbody></table></div>    </div>
  </li>
  <li>if php no include these config, reinstall : <code class="highlighter-rouge">brew install php70 --with-homebrew-curl</code></li>
</ul>

<h2 id="code">code</h2>

<h3 id="send-method">send method</h3>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36<br/>37<br/>38<br/>39<br/>40<br/>41<br/>42<br/>43<br/>44<br/>45<br/>46<br/>47<br/>48</pre></td><td class="code"><pre class="highlight"><code>/**
 * @param $http2ch          the curl connection
 * @param $http2_server     the Apple server url
 * @param $apple_cert       the path to the certificate
 * @param $app_bundle_id    the app bundle id
 * @param $message          the payload to send (JSON)
 * @param $token            the token of the device
 * @return mixed            the status code
 */
function sendHTTP2Push($http2ch, $http2_server, $apple_cert, $app_bundle_id, $message, $token) {

    // url (endpoint)
    $url = "{$http2_server}/3/device/{$token}";

    // certificate
    $cert = realpath($apple_cert);

    // headers
    $headers = array(
        "apns-topic: {$app_bundle_id}",
        "User-Agent: My Sender"
    );

    // other curl options
    curl_setopt_array($http2ch, array(
        CURLOPT_URL =&gt; $url,
        CURLOPT_PORT =&gt; 443,
        CURLOPT_HTTPHEADER =&gt; $headers,
        CURLOPT_POST =&gt; TRUE,
        CURLOPT_POSTFIELDS =&gt; $message,
        CURLOPT_RETURNTRANSFER =&gt; TRUE,
        CURLOPT_TIMEOUT =&gt; 30,
        CURLOPT_SSL_VERIFYPEER =&gt; false,
        CURLOPT_SSLCERT =&gt; $cert,
        CURLOPT_HEADER =&gt; 1
    ));

    // go...
    $result = curl_exec($http2ch);
    if ($result === FALSE) {
      throw new Exception("Curl failed: " .  curl_error($http2ch));
    }

    // get response
    $status = curl_getinfo($http2ch, CURLINFO_HTTP_CODE);

    return $status;
}
</code></pre></td></tr></tbody></table></div></div>

<h3 id="use">use</h3>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20</pre></td><td class="code"><pre class="highlight"><code>// this is only needed with php prior to 5.5.24
if (!defined('CURL_HTTP_VERSION_2_0')) {
  define('CURL_HTTP_VERSION_2_0', 3);
}
// open connection 
$http2ch = curl_init();
curl_setopt($http2ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_2_0);

// send push
$apple_cert = '/certificates/samplepush/development.pem';
$message = '{"aps":{"alert":"Hi!","sound":"default"}}';
$token = 'dbdaeae86abcde56rtyww1859fb41b2cby053ec48987847';
$http2_server = 'https://api.development.push.apple.com'; // or 'api.push.apple.com' if production
$app_bundle_id = 'it.tabasoft.samplepush';

$status = sendHTTP2Push($http2ch, $http2_server, $apple_cert, $app_bundle_id, $message, $token);
echo "Response from apple -&gt; {$status}\n";

// close connection
curl_close($http2ch);
</code></pre></td></tr></tbody></table></div></div>

<h3 id="response">response</h3>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9</pre></td><td class="code"><pre class="highlight"><code>200 Success
400 Bad request
403 There was an error with the certificate.
405 The request used a bad :method value. Only POST requests are supported.
410 The device token is no longer active for the topic.
413 The notification payload was too large.
429 The server received too many requests for the same device token.
500 Internal server error
503 The server is shutting down and unavailable.
</code></pre></td></tr></tbody></table></div></div>

<h3 id="multi-token-send">multi token send</h3>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6</pre></td><td class="code"><pre class="highlight"><code>// open connection
// send all the pushes
for ($i = 0; $i &lt; $totSends; $i++) {
   // send push
}
// close connection
</code></pre></td></tr></tbody></table></div></div>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/php/2016/10/22/PHP-http2/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/redis/2016/10/19/Redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar3.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/redis/2016/10/19/Redis/" itemprop="url">
                【redis】basic 心得
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-19T10:00:00+08:00">
                2016-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Redis" itemprop="url" rel="index">
                    <span itemprop="name">Redis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="安裝-redis">安裝 redis</h2>

<ul>
  <li>http://redis.io/</li>
  <li>下載後，執行網頁上安裝方法</li>
</ul>

<h3 id="將-redis-安裝到-usrlocalbin-的方法">將 redis 安裝到 /usr/local/bin 的方法</h3>

<ul>
  <li><code class="highlighter-rouge">make install</code>
    <ul>
      <li>更改預設安裝位置 : <code class="highlighter-rouge">make PREFIX=/some/other/directory install</code></li>
    </ul>
  </li>
  <li>此方法會安裝 binaries 到系統中，但相關的 script 與配置檔，並不會放到是到的位置，因為只是 play</li>
  <li>若需要安裝到正式的系統中，請使用
    <ul>
      <li><code class="highlighter-rouge">cd utils</code></li>
      <li><code class="highlighter-rouge">./install_server.sh</code></li>
      <li>此種安裝方式會詢問幾個設定的問題，並且在 sys reboot 後會自動重新啟動</li>
      <li>手動停止與啟動 : <code class="highlighter-rouge">/etc/init.d/redis_&lt;portnumber&gt;</code></li>
    </ul>
  </li>
</ul>

<h2 id="use">use</h2>

<ul>
  <li>啟用伺服器
    <ul>
      <li>直接啟用 : <code class="highlighter-rouge">src/redis-server</code></li>
      <li>制定設定檔 : <code class="highlighter-rouge">./src/redis-server /path/to/redis.conf</code></li>
      <li>透過指令直接覆蓋設定檔 :
        <ul>
          <li><code class="highlighter-rouge">./redis-server --port 9999 --slaveof 127.0.0.1 6379</code></li>
          <li><code class="highlighter-rouge">./redis-server /etc/redis/6379.conf --loglevel debug</code></li>
          <li>在 redis.conf 中的參數名稱，全部都支援使用 command line 進行設定。</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>啟用 client
    <ul>
      <li><code class="highlighter-rouge">src/redis-cli</code>，進入互動介面</li>
      <li>測試
        <ul>
          <li><code class="highlighter-rouge">ping</code></li>
          <li><code class="highlighter-rouge">set foo bar</code></li>
          <li><code class="highlighter-rouge">get foo</code></li>
        </ul>
      </li>
      <li>可直接下指令 <code class="highlighter-rouge">./redis_cli get foo</code> 取得參數</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">./redis_cli --help</code> : 查看一般指令</li>
  <li><code class="highlighter-rouge">./redis_cli help {cmd}</code> : 取得指令相關資訊</li>
  <li><code class="highlighter-rouge">./redis_cli command</code> : 取得全部指令</li>
</ul>

<h2 id="特性">特性</h2>

<ul>
  <li>redis 是一個 key-value 的資料庫</li>
  <li>資料結構儲存的特性
    <ul>
      <li>儲存於 disk 上，儘管修改是透過 server memory。代表 redis 是快速的，也代表儲存是持久性的。</li>
      <li>在相同的高階編程語言下，redis 的效能結構儲存，相對優秀</li>
      <li>Redis 提供很多 database 上習慣性的方法，如複製、tunable levels of durability、叢集、高度擴展</li>
    </ul>
  </li>
  <li>Redis 提供更多複雜的使用方法，在 memcached 上。</li>
  <li>more
    <ul>
      <li>Introduction to Redis data types. http://redis.io/topics/data-types-intro</li>
      <li>Try Redis directly inside your browser. http://try.redis.io</li>
      <li>The full list of Redis commands. http://redis.io/commands</li>
      <li>There is much more inside the Redis official documentation. http://redis.io/documentation</li>
    </ul>
  </li>
  <li>資料類型 : strings, arrays, integers, NULL, errors and so forth</li>
</ul>

<h2 id="測試">測試</h2>

<ul>
  <li>將 server 關閉後，依然取得到 key-value</li>
</ul>

<h2 id="redis-cli">redis-cli</h2>

<h3 id="basic">basic</h3>

<ul>
  <li>計數 : <code class="highlighter-rouge">redis-cli incr {變數名稱}</code></li>
  <li>寫入檔案 : <code class="highlighter-rouge">redis-cli incr {變數名稱} &gt; ./output.txt</code></li>
  <li>取得 : <code class="highlighter-rouge">redis-cli get {變數名稱}</code>
    <ul>
      <li>指定輸出為 raw <code class="highlighter-rouge">redis-cli --raw get {變數名稱}</code></li>
    </ul>
  </li>
  <li>刪除 :
    <ul>
      <li><code class="highlighter-rouge">./redis-cli del {變數名稱}</code></li>
      <li><code class="highlighter-rouge">./redis-cli flushall</code> : 刪除全部 keys from all db</li>
      <li><code class="highlighter-rouge">./redis-cli flushdb</code> : 從目前的 db 刪除掉所有的 keys</li>
    </ul>
  </li>
  <li>設定 : <code class="highlighter-rouge">redis-cli set {變數名稱}</code></li>
  <li>查看變數編碼屬性 : <code class="highlighter-rouge">OBJECT ENCODING {變數名稱}</code>
    <ul>
      <li>int</li>
      <li>raw</li>
      <li>embstr</li>
      <li>more : <a href="http://redisbook.com/preview/object/string.html">http://redisbook.com/preview/object/string.html</a></li>
    </ul>
  </li>
  <li>接續 : <code class="highlighter-rouge">redis-cli append {變數名稱} "{延伸內容}"</code></li>
  <li>列出所有的 {變數名稱} : <code class="highlighter-rouge">KEYS *</code>
    <ul>
      <li>列出指定內容的 {變數名稱} : <code class="highlighter-rouge">KEYS *o*</code></li>
    </ul>
  </li>
  <li>查看 {變數名稱} 是否存在 : <code class="highlighter-rouge">./redis-cli exists {變數名稱} ...</code></li>
</ul>

<h3 id="host-port-password-and-database">Host, port, password and database</h3>

<ul>
  <li>Host, port
    <ul>
      <li>預設的 ./redis-cli 設定為
        <ul>
          <li>server : 127.0.0.1</li>
          <li>port : 6379</li>
        </ul>
      </li>
      <li>specify <code class="highlighter-rouge">-h</code> &amp; <code class="highlighter-rouge">-p</code> : <code class="highlighter-rouge">./redis-cli -h redis15.localnet.org -p 6390 ping</code></li>
    </ul>
  </li>
  <li>password
    <ul>
      <li><code class="highlighter-rouge">./redis-cli a {password} ping</code></li>
    </ul>
  </li>
  <li>database
    <ul>
      <li>預設會有 16 個 db，db 的名稱是用數字表達</li>
      <li>basic
        <ul>
          <li>查詢 db 數量 : <code class="highlighter-rouge">./redis-cli CONFIG GET databases</code></li>
          <li>查詢每個 db 中的內存 : <code class="highlighter-rouge">./redis-cli INFO keyspace</code></li>
          <li>指定 db 設定參數 : <code class="highlighter-rouge">./redis-cli -n 1 set {變數名稱} {內容}</code>
            <ul>
              <li>n 預設為 0</li>
            </ul>
          </li>
          <li>顯示目前此 db 的 key 數量 : <code class="highlighter-rouge">./redis-cli dbsize</code></li>
          <li>移動 key 到另一個 db : <code class="highlighter-rouge">./redis-cli move {db_number}</code></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="special-modes-of-operation--redis-cli---help">Special modes of operation : <code class="highlighter-rouge">./redis-cli --help</code></h3>

<ul>
  <li>即時查看系統狀態 : <code class="highlighter-rouge">./redis-cli --stat</code></li>
  <li>分析 key : <code class="highlighter-rouge">redis-cli --bigkeys</code></li>
  <li>Getting a list of keys :
    <ul>
      <li><code class="highlighter-rouge">./redis-cli --scan | head -10</code></li>
      <li><code class="highlighter-rouge">./redis-cli --scan --pattern '*-11*'</code></li>
      <li><code class="highlighter-rouge">redis-cli --scan --pattern 'user:*' | wc -l</code></li>
    </ul>
  </li>
  <li>Pub/sub mode
    <ul>
      <li><code class="highlighter-rouge">publish {channel} {message}</code></li>
      <li><code class="highlighter-rouge">subscribe {channel} ...</code></li>
      <li><code class="highlighter-rouge">psubscribe {pattern}</code> : 設定 pattern 直接訂閱相關的頻道
        <ul>
          <li>pattern : <code class="highlighter-rouge">?, * , [ab]</code>
            <ul>
              <li><code class="highlighter-rouge">h?llo</code> 訂閱所有 <code class="highlighter-rouge">h?ll0</code> 相關頻道，只有一個字元</li>
              <li><code class="highlighter-rouge">h*llo</code> 訂閱所有 <code class="highlighter-rouge">h*llo</code> 相關頻道，<code class="highlighter-rouge">*</code> 可以是多個字元</li>
              <li><code class="highlighter-rouge">h[ae]llo</code> 訂閱 hallo 與 hello 頻道</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>即時監控目前 redis 所有的參數 : <code class="highlighter-rouge">./redis-cli monitor</code></li>
  <li>測試＋模擬 redis 的延遲 (以毫秒計):
    <ul>
      <li>基本 : <code class="highlighter-rouge">./redis-cli --latency -h {host} -p {port}</code>，可跨伺服器測試，預設為 localhost:6390</li>
      <li>每 15 秒 重新產生一次測試 : <code class="highlighter-rouge">./redis-cli --latency-history</code></li>
      <li>圖像化顯示 : <code class="highlighter-rouge">./redis-cli --latency-dist</code></li>
      <li>測試 redis 內部延遲，此依賴 cpu 效能
        <ul>
          <li><code class="highlighter-rouge">./redis-cli --intrinsic-latency {秒數}</code> : 在 {秒數} 內測試</li>
        </ul>
      </li>
      <li>文章
        <ul>
          <li><a href="https://read01.com/yz68z4.html">淺談 Redis 超時</a></li>
          <li><a href="https://read01.com/O3a48K.html">Redis性能調優：保存SNAPSHOT對性能的影響</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Remote backups of RDB files
    <ul>
      <li><code class="highlighter-rouge">./redis-cli --rdb /tmp/dump.rdb</code></li>
    </ul>
  </li>
  <li>透過此指令，會複製 redis 上面載入的指令，到 slave，可清楚的看到下的指令順序是否正確
    <ul>
      <li><code class="highlighter-rouge">redis-cli --slave</code></li>
    </ul>
  </li>
  <li>Performing an LRU simulation
    <ul>
      <li>使用 LRU 測試，模擬效能</li>
      <li>透過設定 memory 與測試的 keys，來觀察效率 miss 的比例</li>
      <li><a href="http://redis.io/topics/rediscli#performing-an-lru-simulation">http://redis.io/topics/rediscli#performing-an-lru-simulation</a> 此篇有測試的過程</li>
    </ul>
  </li>
</ul>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/redis/2016/10/19/Redis/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/ssh/2016/10/14/SSH-Remote-Access/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar3.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/ssh/2016/10/14/SSH-Remote-Access/" itemprop="url">
                【SSH】設定簡易遠端登入
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-14T08:01:00+08:00">
                2016-10-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/SSH" itemprop="url" rel="index">
                    <span itemprop="name">SSH</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="readme">readme</h1>

<ul>
  <li>env : osx 10.11</li>
  <li>使用 ssh 配置，便易登入遠端 server</li>
</ul>

<h1 id="sshconfig">.ssh/config</h1>

<blockquote>
  <p>所有的參數列表 https://linux.die.net/man/5/ssh_config，see PATTERNS</p>
</blockquote>

<ul>
  <li>Host  {本機辨識的名稱}</li>
  <li>HostName</li>
  <li>Port</li>
  <li>User</li>
</ul>

<h2 id="相關參數">相關參數</h2>

<ul>
  <li>Host</li>
  <li>HostNmae</li>
  <li>User</li>
  <li>Port : 連線端口</li>
  <li>DynamicForward : 本地端口</li>
</ul>

<h2 id="範例">範例</h2>

<blockquote>
  <p>登入遠端主機</p>
</blockquote>

<ol>
  <li>設定檔
    <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5</pre></td><td class="code"><pre class="highlight"><code># server
Host dev
HostName dev.max.com
Port 8888
User root
</code></pre></td></tr></tbody></table></div>    </div>
  </li>
  <li><code class="highlighter-rouge">ssh dev</code></li>
</ol>

<h2 id="金鑰">金鑰</h2>

<blockquote>
  <p>若需設定伺服器金鑰，進行遠端登入</p>
</blockquote>

<ol>
  <li>在本機端生成金鑰 <code class="highlighter-rouge">$ ssh-keygen -t rsa -b 4096 -C "your_email@example.com"</code></li>
  <li>上傳 pub_key 到伺服器端</li>
  <li>將 key 匯入 <code class="highlighter-rouge">~/.ssh/authorized_keys</code></li>
  <li><code class="highlighter-rouge">chmod 600 ~/.ssh/authorized_keys</code></li>
  <li>設定伺服器端配置，<code class="highlighter-rouge">/etc/ssh/sshd_config</code>
    <ul>
      <li>PubkeyAuthentication yes
      - PasswordAuthentication no</li>
    </ul>
  </li>
  <li>重啟 sshd 服務</li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/ssh/2016/10/14/SSH-Remote-Access/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
      
    </footer>
  </article>

  
</section>


  <nav class="pagination">
    
    
    



    <a class="extend prev" rel="prev" href="/blogpost/page6"><i class="fa fa-angle-left"></i></a> <a class="page-number" href="/blogpost/">1</a> <span class="space">&hellip;</span> <a class="page-number" href="/blogpost/page6">6</a> <span class="page-number current">7</span> <a class="page-number" href="/blogpost/page8">8</a> <span class="space">&hellip;</span> <a class="page-number" href="/blogpost/page11">11</a> <a class="extend prev" rel="next" href="/blogpost/page8"><i class="fa fa-angle-right"></i></a>
  </nav>




          </div>
          


          

        </div>
        
          

  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/blogpost/assets/images/avatar3.png"
               alt="Max Hu" />
          <p class="site-author-name" itemprop="name">Max Hu</p>
           
              <p class="site-description motion-element" itemprop="description">Welcome!</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/blogpost/archives/">
                <span class="site-state-item-count">110</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/blogpost/categories/">
                <span class="site-state-item-count">71</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/blogpost/tags/">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
        
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>

        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Max Hu</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





















  
   
  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/jquery/index.js?v=2.1.3"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/blogpost/assets/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/blogpost/assets/js/src/motion.js?v=5.1.1"></script>



  
  

  <script type="text/javascript" src="/blogpost/assets/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/blogpost/assets/js/src/post-details.js?v=5.1.1"></script>


  


  <script type="text/javascript" src="/blogpost/assets/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  











  




  

    

  







  






  

  

  
  


  

  

  

</body>
</html>

