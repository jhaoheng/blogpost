
<!doctype html>














<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/blogpost/assets/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/blogpost/assets/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blogpost/assets/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="jhaoheng, maxhu, golang, objective-c" />








  <link rel="shortcut icon" type="image/x-icon" href="/blogpost/assets/favicon.ico?v=5.1.1" />
















<meta name="description" content="Welcome!">
<meta name="keywords" content="jhaoheng, maxhu, golang, objective-c">
<meta property="og:type" content="website">
<meta property="og:title" content="MAX 呼~">
<meta property="og:url" content="https://jhaoheng.github.io/blogpost/blogpost/page4/">
<meta property="og:site_name" content="MAX 呼~">
<meta property="og:description" content="Welcome!">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MAX 呼~">
<meta name="twitter:description" content="Welcome!">


<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blogpost',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"hide","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://jhaoheng.github.io/blogpost/blogpost"/>





  <title>MAX 呼~</title>
  
















</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  

  <div class="container sidebar-position-left page-home ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blogpost/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">MAX 呼~</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Spare No Effort, Leave No Regret</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
        
        <li class="menu-item menu-item-home">
          <a href="/blogpost/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-archives">
          <a href="/blogpost/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-tags">
          <a href="/blogpost/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            



<section id="posts" class="posts-expand">
  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/docker/mariadb/2017/09/05/Docker-MariaDB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/docker/mariadb/2017/09/05/Docker-MariaDB/" itemprop="url">
                【docker : mariadb】container 建立後，初始化 schema
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-05T06:07:00+08:00">
                2017-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Docker" itemprop="url" rel="index">
                    <span itemprop="name">Docker</span>
                  </a>
                </span>

                
                
                  , 
                
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/MariaDB" itemprop="url" rel="index">
                    <span itemprop="name">MariaDB</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="first">first</h2>

<ul>
  <li>目的 : 在 docker 架構下，解決 mariadb container 建立後，自動加入 schema 到 db 中</li>
  <li>可參考 https://stackoverflow.com/questions/36617682/docker-compose-mysql-import-sql</li>
  <li>解決 : 在 mariadb 起來後，會自動去執行 <code class="highlighter-rouge">/docker-entrypoint-initdb.d/</code> 底下的 sql 指令，就會自動建立好預設的 database &amp; table</li>
</ul>

<h2 id="example--docker-compose">example : docker-compose</h2>

<h3 id="sql-file--save-as-testsql">sql file : save as test.sql</h3>
<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22</pre></td><td class="code"><pre class="highlight"><code>#
# SQL Export
# Created by Querious (1068)
# Created: 2017年9月5日 GMT+8 上午9:27:31
# Encoding: Unicode (UTF-8)
#

CREATE DATABASE IF NOT EXISTS `test` DEFAULT CHARACTER SET latin1 DEFAULT COLLATE latin1_swedish_ci;
USE `test`;

SET @PREVIOUS_FOREIGN_KEY_CHECKS = @@FOREIGN_KEY_CHECKS;
SET FOREIGN_KEY_CHECKS = 0;

CREATE TABLE `event` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `user_id` varchar(128) DEFAULT NULL,
  `type` varchar(128) DEFAULT NULL,
  `created_timestamp` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

SET FOREIGN_KEY_CHECKS = @PREVIOUS_FOREIGN_KEY_CHECKS;
</code></pre></td></tr></tbody></table></div></div>

<h3 id="docker-composeyml">docker-compose.yml</h3>
<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11</pre></td><td class="code"><pre class="highlight"><code>version: '3.0'
services:
  mariadb:
    image: mariadb
    container_name: some-mariadb
    ports:
      - 3306:3306/tcp
    environment:
      - MYSQL_ROOT_PASSWORD=1234
    volumes:
      - test.sql:/docker-entrypoint-initdb.d/test.sql
</code></pre></td></tr></tbody></table></div></div>

<h3 id="驗證">驗證</h3>

<ol>
  <li><code class="highlighter-rouge">docker exec some-mariadb mysql -u root --password=1234 --database=test -e "show tables;"</code></li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/docker/mariadb/2017/09/05/Docker-MariaDB/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/aws/2017/08/25/AWS-CLI-ECR-S3-EB-Deploy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/aws/2017/08/25/AWS-CLI-ECR-S3-EB-Deploy/" itemprop="url">
                【AWS CLI】ECR & S3 & EB deploy
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-25T17:11:00+08:00">
                2017-08-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/AWS" itemprop="url" rel="index">
                    <span itemprop="name">AWS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="建立-aws-docker-image-repo">建立 aws docker image repo</h2>
<ol>
  <li>建立 ECR
    <ol>
      <li>開啟 AWS console -&gt; 選擇 Amazon ECS 的服務 -&gt; 選擇 Repositories</li>
      <li>選擇 create repository</li>
      <li>建立完成後，會看到上傳的方法</li>
    </ol>
  </li>
  <li>按照 ecs 中，的說明 aws ecr get-login 後，會產生出 docker login … 的語法，透過這個進行 docker login
    <ol>
      <li><code class="highlighter-rouge">aws ecr get-login --no-include-email --region us-east-1</code> : 取得 <code class="highlighter-rouge">docker login -u AWS -p .... </code></li>
      <li>依據 1 中取得的 login 指令，進行 docker login</li>
    </ol>
  </li>
  <li>上傳 docker image 到 ECR 中
    <ol>
      <li><code class="highlighter-rouge">docker build -t xxx {image}</code></li>
      <li><code class="highlighter-rouge">docker tag xxx your-ecr-position/your-repo-name:latest</code></li>
      <li><code class="highlighter-rouge">docker push your-ecr-position/your-repo-name:latest</code></li>
    </ol>
  </li>
</ol>

<h2 id="透過-beanstalk-部署">透過 beanstalk 部署</h2>

<ol>
  <li>建立好一個 eb application</li>
  <li>設定好 <code class="highlighter-rouge">Dockerrun.aws.json</code>
    <ul>
      <li><code class="highlighter-rouge">envsubst</code> 可善用此指令</li>
    </ul>
  </li>
  <li>壓縮 含有設定檔的 folder，並上傳到 aws s3
    <ul>
      <li><code class="highlighter-rouge">cd folder &amp;&amp; zip -r $folder.zip ./ &amp;&amp; aws s3 cp $folder.zip s3://{bucket_name}/{folder.zip}</code></li>
    </ul>
  </li>
  <li>建立 eb 新的版本
    <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4</pre></td><td class="code"><pre class="highlight"><code>aws elasticbeanstalk create-application-version \
--application-name {your-eb-application-name} \
  --version-label {your-eb-version-label}\
  --source-bundle S3Bucket={bucket_name},S3Key={folder.zip}
</code></pre></td></tr></tbody></table></div>    </div>
  </li>
  <li>部署新版本
    <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3</pre></td><td class="code"><pre class="highlight"><code>aws elasticbeanstalk update-environment \
--environment-name {your-eb-application-name} \
  --version-label {your-eb-version-label}
</code></pre></td></tr></tbody></table></div>    </div>
  </li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/aws/2017/08/25/AWS-CLI-ECR-S3-EB-Deploy/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/aws/2017/08/25/AWS-CLI-configure/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/aws/2017/08/25/AWS-CLI-configure/" itemprop="url">
                【AWS CLI】profile : configure
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-25T03:59:00+08:00">
                2017-08-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/AWS" itemprop="url" rel="index">
                    <span itemprop="name">AWS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="purpose">PURPOSE</h1>
<ol>
  <li>了解 aws cli profile 運作方式</li>
  <li>了解 aws cli configure 操作方法</li>
</ol>

<h1 id="aws-cli">aws cli</h1>

<ul>
  <li>github : https://github.com/aws/aws-cli/releases</li>
  <li>安裝 &amp; 更新 &amp; 反安裝 : <code class="highlighter-rouge">http://docs.aws.amazon.com/cli/latest/userguide/installing.html</code></li>
  <li>cli 中指令的參考 : <code class="highlighter-rouge">http://docs.aws.amazon.com/cli/latest/index.html</code>
    <ul>
      <li><code class="highlighter-rouge">aws help</code> : 可看到所有指令</li>
    </ul>
  </li>
  <li>查詢各類指令說明 :
    <ul>
      <li><code class="highlighter-rouge">aws help</code></li>
      <li><code class="highlighter-rouge">aws {command} help</code></li>
      <li><code class="highlighter-rouge">aws {command} {sub-cmd} help</code></li>
    </ul>
  </li>
  <li>aws Command Completion : <code class="highlighter-rouge">http://docs.aws.amazon.com/cli/latest/userguide/cli-command-completion.html</code>
    <ul>
      <li>透過 tab 搜尋 aws 相關指令, install :
        <ol>
          <li><code class="highlighter-rouge">echo $SHELL</code></li>
          <li>find path : <code class="highlighter-rouge">which aws_completer</code></li>
          <li>enable : <code class="highlighter-rouge">complete -C '/usr/local/bin/aws_completer' aws</code></li>
        </ol>
      </li>
    </ul>
  </li>
</ul>

<h2 id="設定-profile">設定 profile</h2>
<ul>
  <li>resource : <code class="highlighter-rouge">http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html</code></li>
  <li>請到 iam 取得以下
    <ul>
      <li>AWS Access Key ID</li>
      <li>AWS Secret Access Key</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">aws configure help</code> : 查詢在 configure 中的指令有哪些可用</li>
  <li>設定 profile
    <ul>
      <li><code class="highlighter-rouge">aws configure</code></li>
      <li><code class="highlighter-rouge">aws configure --profile user2</code></li>
    </ul>
  </li>
  <li>列出 profile
    <ul>
      <li><code class="highlighter-rouge">aws configure list</code> : 預設</li>
      <li><code class="highlighter-rouge">aws configure list --profile default</code> : 指定身份</li>
    </ul>
  </li>
  <li>使用 profile
    <ul>
      <li><code class="highlighter-rouge">aws ec2 describe-instance</code></li>
      <li><code class="highlighter-rouge">aws ec2 describe-instance --profile user2</code></li>
    </ul>
  </li>
  <li>指定使用哪一個 profile
    <ul>
      <li><code class="highlighter-rouge">export AWS_PROFILE=user2</code> : AWS_PROFILE 為 Environment Variables</li>
      <li><code class="highlighter-rouge">unset AWS_PROFILE</code> : 回到預設值</li>
      <li>Profile Environment Variables
        <ul>
          <li>AWS_ACCESS_KEY_ID</li>
          <li>AWS_SECRET_ACCESS_KEY</li>
          <li>AWS_SESSION_TOKEN</li>
          <li>AWS_DEFAULT_REGION</li>
          <li>AWS_DEFAULT_OUTPUT</li>
          <li>AWS_PROFILE</li>
          <li>AWS_CA_BUNDLE</li>
          <li>AWS_SHARED_CREDENTIALS_FILE</li>
          <li>AWS_CONFIG_FILE</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Options
    <ul>
      <li><code class="highlighter-rouge">--profile</code>		: 指定使用 profile</li>
      <li><code class="highlighter-rouge">--region</code> 		: 指定地區
        <ul>
          <li>顯示地區列表 : <code class="highlighter-rouge">aws ec2 describe-regions --output table</code></li>
        </ul>
      </li>
      <li>
        <table>
          <tbody>
            <tr>
              <td><code class="highlighter-rouge">--output</code> 		: json</td>
              <td>text</td>
              <td>table</td>
            </tr>
          </tbody>
        </table>
      </li>
      <li><code class="highlighter-rouge">--endpoint-url</code> : 指定</li>
      <li>ex : <code class="highlighter-rouge">aws ec2 describe-instances --output table --region ap-northeast-2</code></li>
    </ul>
  </li>
</ul>

<h1 id="example">example</h1>

<ol>
  <li>想要列出目前預設使用的 profile 使哪一張
    <ul>
      <li><code class="highlighter-rouge">aws configure list</code></li>
    </ul>
  </li>
  <li>想指定預設的 profile
    <ul>
      <li><code class="highlighter-rouge">export AWS_PROFILE=xxx</code></li>
    </ul>
  </li>
  <li>想取消指定 profile，回到 default
    <ul>
      <li><code class="highlighter-rouge">unset AWS_PROFILE</code></li>
    </ul>
  </li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/aws/2017/08/25/AWS-CLI-configure/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/papertrial/logspout/2017/08/18/Papertrial-logspout/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/papertrial/logspout/2017/08/18/Papertrial-logspout/" itemprop="url">
                【log tool】papertrial+logspout
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-18T07:51:00+08:00">
                2017-08-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Papertrial" itemprop="url" rel="index">
                    <span itemprop="name">Papertrial</span>
                  </a>
                </span>

                
                
                  , 
                
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Logspout" itemprop="url" rel="index">
                    <span itemprop="name">Logspout</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="papertrail">papertrail</h2>

<ul>
  <li>申請一個 papertrail 帳號</li>
  <li>建立一個 Log Destinations : 會得到 <code class="highlighter-rouge">logsx.papertrailapp.com:46888</code></li>
</ul>

<h2 id="logspout">logspout</h2>

<ul>
  <li>建立 docker container
    <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6</pre></td><td class="code"><pre class="highlight"><code>docker run --name="logspout" \
-d \
-e SYSLOG_HOSTNAME=test_name \
--volume=/var/run/docker.sock:/var/run/docker.sock \
gliderlabs/logspout \
{your_papertrail_log_destination}
</code></pre></td></tr></tbody></table></div>    </div>
  </li>
  <li>測試
    <ul>
      <li>以下兩種方法可以在 papertrial 的 log 中看到
        <ol>
          <li>docker run -p 80:80 centos /bin/echo hello =&gt; 在 papertrial 印出 hello</li>
          <li>docker run -p 81:81 centos /bin/date =&gt; 在 papertrial 印出 日期</li>
          <li>docker run -i -d -p 80:80 centos /bin/bash
            <ul>
              <li><code class="highlighter-rouge">docker exec -it [container_id] /bin/bash</code></li>
            </ul>
            <ul>
              <li>echo hello » /proc/1/fd/1 =&gt; 在 papertrial 印出 hello</li>
            </ul>
          </li>
        </ol>
      </li>
      <li>注意 : docker run 用 -t 啟用的話，就不會被 logspout 給監聽到</li>
      <li>注意 : logging driver 只支援 <code class="highlighter-rouge">journald</code>, <code class="highlighter-rouge">json-file</code></li>
    </ul>
  </li>
</ul>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/papertrial/logspout/2017/08/18/Papertrial-logspout/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/ejabberd/2017/08/17/Ejabberd-docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/ejabberd/2017/08/17/Ejabberd-docker/" itemprop="url">
                【EJABBERD 17.07】dockerfile
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-17T10:16:00+08:00">
                2017-08-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Ejabberd" itemprop="url" rel="index">
                    <span itemprop="name">Ejabberd</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15</pre></td><td class="code"><pre class="highlight"><code>FROM        ubuntu:16.04

EXPOSE      5222 5280 5269 4560

WORKDIR     /home

ENV         DL=https://www.process-one.net/downloads/ejabberd/17.07/ejabberd_17.07-0_amd64.deb
ENV			EJABBERD_HOME_NAME=ejabberd-17.07
ENV         DL_FILENAME=$EJABBERD_HOME_NAME.deb 

RUN         apt-get update
RUN 		apt-get install libexpat1 apt-utils -y
RUN         apt-get install wget vim -y
RUN         wget -O $DL_FILENAME $DL
RUN         dpkg -i $DL_FILENAME
</code></pre></td></tr></tbody></table></div></div>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/ejabberd/2017/08/17/Ejabberd-docker/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/ejabberd/2017/08/06/Ejabberd-Jabsimul/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/ejabberd/2017/08/06/Ejabberd-Jabsimul/" itemprop="url">
                【ejabberd stress】use Jabsimul
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-06T06:26:00+08:00">
                2017-08-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Ejabberd" itemprop="url" rel="index">
                    <span itemprop="name">Ejabberd</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="ejabberd-stressuse-jabsimul">【ejabberd stress】use Jabsimul</h1>

<h1 id="環境">環境</h1>

<ul>
  <li>aws instance t2.micro</li>
  <li>ubuntu 16.04</li>
</ul>

<h1 id="安裝">安裝</h1>

<ol>
  <li>安裝 ejabberd 本體
    <ul>
      <li><code class="highlighter-rouge">apt-get update</code></li>
      <li>到安裝頁面，選擇 deb，<code class="highlighter-rouge">wget {download source}</code></li>
      <li><code class="highlighter-rouge">dpkg -i {download file}</code></li>
      <li><code class="highlighter-rouge">su ejabberd &amp;&amp; cd ~</code></li>
      <li>檢查你的 host 請更改為 localhost : <code class="highlighter-rouge">vi ./conf/ejabberd.yml</code></li>
      <li>先記錄 {host}</li>
      <li>啟動 ejabberd, <code class="highlighter-rouge">./bin/ejabberdctl start</code></li>
      <li>建立管理者 : <code class="highlighter-rouge">./bin/ejabberdctl register admin {host} admin</code></li>
    </ul>
  </li>
  <li>安裝壓力測試編譯時需要的套件 : <code class="highlighter-rouge">apt-get install cvs make gcc libexpat1-dev libncurses5-dev libssl-dev bison byacc flex -y</code></li>
  <li>安裝 Jabber Test Suite，官方 : http://jabbertest.sourceforge.net/
    <ol>
      <li>確定切換回 root, cd /home/ubuntu</li>
      <li><code class="highlighter-rouge">cvs -z3 -d:pserver:anonymous@jabbertest.cvs.sourceforge.net:/cvsroot/jabbertest co testsuite</code></li>
      <li><code class="highlighter-rouge">cd testsuite/ &amp;&amp; cp Makefile.linux Makefile &amp;&amp; make userreg</code></li>
      <li>查詢 <code class="highlighter-rouge">./userreg -?</code> 的使用方法</li>
      <li><code class="highlighter-rouge">./userreg -h 127.0.0.1 -u 3000 -n 1 -o ./output</code></li>
      <li><code class="highlighter-rouge">cat ./output</code> 如果成功會顯示類似，無意外會有 3000 筆資訊</li>
      <li>如果沒有，請將 <code class="highlighter-rouge">ejabberd stop</code> then <code class="highlighter-rouge">start</code></li>
    </ol>
  </li>
  <li>安裝 Jabsimul
    <ol>
      <li>確定切換回 root, cd /home/ubuntu</li>
      <li><code class="highlighter-rouge">wget http://www.ejabberd.im/files/other/jabsimul.tar.gz</code></li>
      <li><code class="highlighter-rouge">tar xzf jabsimul.tar.gz</code></li>
      <li><code class="highlighter-rouge">cp jab_simul.xml.example jab_simul.xml</code></li>
      <li><code class="highlighter-rouge">./configure &amp;&amp; make</code></li>
      <li>調整設定值，開啟 <code class="highlighter-rouge">jab_simul.xml</code> : 參考 <code class="highlighter-rouge">http://tkabber.jabber.ru/files/badlop/jab_simul.xml.chat60</code></li>
      <li>注意 <code class="highlighter-rouge">jab_simul.xml</code> 中，server 的位置，必須是可解析的 DNS，不能用 ip</li>
      <li>開始執行壓力測試 <code class="highlighter-rouge">./jab_simul</code></li>
      <li>請壓到你預設的數據人數，再去查看現在的資源狀態</li>
    </ol>
  </li>
  <li>如何檢查你的壓力測試 user login 正常?
    <ol>
      <li>檢查你的 ejabberd.log</li>
      <li>檢查 /tmp 底下的 xml testuser 中的訊息</li>
    </ol>
  </li>
  <li><code class="highlighter-rouge">jab_simul</code> 執行後的錯誤訊息
    <ul>
      <li><code class="highlighter-rouge">Socket creation error ! (Too many open files)</code> : 請調整 ulimit 參考其他參數調整</li>
      <li><code class="highlighter-rouge">Segmentation fault (core dumped)</code> : 伺服器超載</li>
    </ul>
  </li>
</ol>

<h1 id="其他參數調整">其他參數調整</h1>
<p>如果要模擬 2000 個用戶，在同一台機上上進行壓力測試，必須設定限制高於 4000 以上</p>

<ul>
  <li>Linux : ulimit -n 16000</li>
</ul>

<p>shaper 是設定查詢允許的流量速度…應該被受限在硬體的效能上…</p>

<ul>
  <li>shaper normal &amp; fast</li>
</ul>

<p>在 ejabberdctl.cfg 中，可設定 ERL_MAX_PORTS &amp; ERL_MAX_ETS_TABLES</p>

<ul>
  <li>ERL_MAX_PORTS : Maximum number of simultaneously open Erlang ports
    <ul>
      <li>ejabberd consumes two or three ports for every connection, either from a client or from another Jabber server. So take this into account when setting this limit.</li>
    </ul>
  </li>
  <li>ERL_MAX_ETS_TABLES : Maximum number of Erlang processes
    <ul>
      <li>The number of concurrent ETS and Mnesia tables is limited. When the limit is reached, errors will appear in the logs: ** Too many db tables **. You can safely increase this limit when starting ejabberd. It impacts memory consumption but the difference will be quite small.</li>
    </ul>
  </li>
</ul>

<p>什麼是 ETS =&gt; Erlang Term Storage
什麼是 DETS =&gt; Disk Erlang Term Storage</p>

<h1 id="查詢壓力測試數據">查詢壓力測試數據</h1>

<ul>
  <li>記憶體
    <ol>
      <li>測試前 : <code class="highlighter-rouge">free -k</code></li>
      <li>測試後 : <code class="highlighter-rouge">free -k</code></li>
    </ol>
  </li>
  <li>使用 top 指令</li>
  <li>可參考 : http://fecbob.pixnet.net/blog/post/39256167-linux%E4%B8%AD%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%B5%B1%E8%B3%87%E6%BA%90%E4%BD%94%E7%94%A8%E6%83%85%E6%B3%81%E7%9A%84%E5%91%BD%E4%BB%A4</li>
</ul>

<h1 id="壓力測試數據參考">壓力測試數據參考</h1>
<p>在 t2.micro 底下約 7500 人，同時在線</p>

<div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2</pre></td><td class="code"><pre class="highlight"><code>  PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND                                                                                                                      
12022 root      20   0   84416  68836   4084 R 66.0  6.8   0:30.64 jab_simul 
</code></pre></td></tr></tbody></table></div></div>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/ejabberd/2017/08/06/Ejabberd-Jabsimul/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/2017/08/03/through-github-slack-subscription-release-rss/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/2017/08/03/through-github-slack-subscription-release-rss/" itemprop="url">
                透過 slack 訂閱 github release RSS
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-03T14:46:00+08:00">
                2017-08-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h2 id="目的">目的</h2>

<p>當使用越來越多的工具時，有時新版的 release 來不及跟上，變成版本落差極大，透過 slack rss bot 的幫忙，當 release 有更新時，透過 msg 通知</p>

<h2 id="需要工具">需要工具</h2>

<ul>
  <li>slack rss bot install : https://slack.com/apps/A0F81R7U7-rss</li>
  <li>github release rss
    <ol>
      <li>找到一個你想要訂閱的 github</li>
      <li>點選 release 的 item</li>
      <li>在 url 的尾端加上 <code class="highlighter-rouge">.atom</code> 即可。ex: https://github.com/xxxx/yyyy/releases.atom</li>
      <li>copy url to slack rss</li>
    </ol>
  </li>
</ul>



          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/2017/08/03/through-github-slack-subscription-release-rss/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/2017/07/15/docker-docker-machine-operation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/2017/07/15/docker-docker-machine-operation/" itemprop="url">
                【Docker】docker-machine 部署到 aws
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-15T00:33:00+08:00">
                2017-07-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="使用-docker-machine-部署-docker-到-aws">使用 docker-machine 部署 docker 到 aws</h1>

<ul>
  <li>參考 : <code class="highlighter-rouge">https://docs.docker.com/machine/drivers/aws/</code></li>
  <li>指令參數表 : <code class="highlighter-rouge">https://docs.docker.com/machine/drivers/aws/#options</code>
    <ul>
      <li>有些預設的參數要注意，如果沒有指定的情況下，會依照預設參數來建立 aws instance
        <ul>
          <li>ex : ami, region, zone, group, instance-type, device-name, root-size, volume-type, ssh-user, request-spot-instance, spot-price, use-private-address, private-address-only, monitoring, use-ebs-optimized-instance, retries</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="其他部署文章參考">其他部署文章參考</h1>
<ul>
  <li>nvidia-docker Deploy on Amazon EC2 : <code class="highlighter-rouge">https://github.com/NVIDIA/nvidia-docker/wiki/Deploy-on-Amazon-EC2</code></li>
</ul>

<h2 id="aws-credentials">aws credentials</h2>
<ol>
  <li>登入 aws</li>
  <li>進入 IAM</li>
  <li>選擇 user</li>
  <li>給予需要使用的權限，在這邊選擇 ec2</li>
  <li>取得該 user 的 <code class="highlighter-rouge">AWS Access Key ID</code> 與 <code class="highlighter-rouge">AWS Secret Access Key</code></li>
  <li>在使用 docker-machine 前，可使用以下兩種方法
    <ol>
      <li>通過 aws credentials 來設定 <code class="highlighter-rouge">AWS Access Key ID</code> 與 <code class="highlighter-rouge">AWS Secret Access Key</code>，建立的方法也有兩種
        <ol>
          <li>可透過 awscli，通過指令 <code class="highlighter-rouge">aws configure</code> 可協助設定好</li>
          <li>也可直接建立 <code class="highlighter-rouge">~/.aws/credentials</code>，顯示格式如下
            <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3</pre></td><td class="code"><pre class="highlight"><code>[default]
aws_access_key_id = AKID1234567890
aws_secret_access_key = MY-SECRET-KEY
</code></pre></td></tr></tbody></table></div>            </div>
          </li>
        </ol>
      </li>
      <li>可透過 docker-machine : <code class="highlighter-rouge">$ docker-machine create --driver amazonec2 --amazonec2-access-key AKI******* --amazonec2-secret-key 8T93C*******  aws01</code> 來建立 docker-machine 的機器</li>
    </ol>
  </li>
  <li>測試建立
    <ul>
      <li><code class="highlighter-rouge">docker-machine create --driver [instance_Name]</code> : 注意 default 參數值
        <ul>
          <li>zone : us-east-1</li>
          <li>instance-type : t2.micro</li>
          <li>root-size : 16</li>
          <li>volume-type : gp2</li>
          <li>ssh-user : ubuntu</li>
          <li>其他資訊請參考 docker-machine 說明</li>
        </ul>
      </li>
      <li>指定部分的參數操作 :
        <div class="highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9</pre></td><td class="code"><pre class="highlight"><code>docker-machine create --driver amazonec2 \
                --amazonec2-region us-west-2 \
                --amazonec2-zone b \
                --amazonec2-ami ami-efd0428f \
                --amazonec2-instance-type p2.xlarge \
                --amazonec2-vpc-id vpc-*** \
                --amazonec2-access-key AKI*** \
                --amazonec2-secret-key *** \
                aws01
</code></pre></td></tr></tbody></table></div>        </div>
      </li>
    </ul>
  </li>
</ol>

<h1 id="未完待續">未完待續</h1>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/2017/07/15/docker-docker-machine-operation/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/docker/sublime/2017/07/05/Docker-Sublime/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/docker/sublime/2017/07/05/Docker-Sublime/" itemprop="url">
                【Docker】use sublime to edit file in docker
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-05T03:56:00+08:00">
                2017-07-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Docker" itemprop="url" rel="index">
                    <span itemprop="name">Docker</span>
                  </a>
                </span>

                
                
                  , 
                
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/Sublime" itemprop="url" rel="index">
                    <span itemprop="name">Sublime</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="sublime-編輯-docker-中的檔案">sublime 編輯 docker 中的檔案</h1>

<p>docker 是個好物的原因在於，環境的穩定，無論遷移到哪個環境中，都可以保持穩定性，debug 也方便許多</p>

<p>但如何直接編輯 docker 建立後的 file？
透過 docker 中的 volume 設定好 application 與 docker 中的位置，就可以直接動態變更 docker 中的檔案資訊</p>

<h1 id="ex--php--phalcon--docker">ex : php / phalcon / docker</h1>

<p><strong>Docker Engine &gt;= 1.10.0 * Docker Compose &gt;= 1.6.2</strong></p>

<ol>
  <li><code class="highlighter-rouge">git clone git@github.com:phalcon/phalcon-compose.git</code></li>
  <li><code class="highlighter-rouge">cp variables.env.example variables.env</code></li>
  <li><code class="highlighter-rouge">docker-compose up -d</code></li>
  <li>開啟網頁 localhost:80</li>
  <li>建立檔案 <code class="highlighter-rouge">./phalcon-compose/application/public/hello.php</code>
    <ul>
      <li><code class="highlighter-rouge">&lt;?php echo "world"; ?&gt;</code></li>
    </ul>
  </li>
  <li>開啟網頁 localhost/hello.php</li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/docker/sublime/2017/07/05/Docker-Sublime/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
          <div class="post-eof"></div>
        
      
    </footer>
  </article>

  
    
    

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://jhaoheng.github.io/blogpost/blogpost/rtmp/2017/06/24/RTMP-Youtube/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Max Hu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAX 呼~">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            
                
                <a class="post-title-link" href="/blogpost/rtmp/2017/06/24/RTMP-Youtube/" itemprop="url">
                【RTMP】youtube to rtmp
              </a>
            
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-24T12:55:00+08:00">
                2017-06-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blogpost/category/#/RTMP" itemprop="url" rel="index">
                    <span itemprop="name">RTMP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
  
  












  <h1 id="目的">目的</h1>
<p>將 youtube 的影片傳給 rtmp server 進行串流</p>

<h1 id="how">how</h1>
<ol>
  <li>找到 youtube 的影片</li>
  <li>進行轉檔為 mp4 : https://www.onlinevideoconverter.com/zh/success?id=b1d3e4d3e4d3g6b1
    <ul>
      <li>或者利用各種轉檔方式</li>
      <li>可下載為 file 也可直接抓取 url (但注意 url 會過期)</li>
      <li>或者把影片存成 mp4 後，放到 server 上</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">docker run --rm jrottenberg/ffmpeg:ubuntu -re -i http://... -vcodec libx264 -preset ultrafast -acodec libfaac -f flv rtmp:...</code>
    <ul>
      <li><code class="highlighter-rouge">-re</code> : Read input at native frame rate. Mainly used to simulate a grab device.  or live input stream (e.g. when reading from a file). Should not be used with actual grab devices or live input streams (where it can cause packet loss).  By default ffmpeg attempts to read the input(s) as fast as possible.  This option will slow down the reading of the input(s) to the native frame rate of the input(s). It is useful for real-time output (e.g. live streaming).</li>
      <li><code class="highlighter-rouge">http://...</code> : 輸入的 mp4 影片位置，也可用 file 來替代</li>
      <li><code class="highlighter-rouge">rmpt://...</code> : 要串流的 rtmp server 位置</li>
    </ul>
  </li>
</ol>


          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/blogpost/rtmp/2017/06/24/RTMP-Youtube/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
        
        
        
        
      
    </footer>
  </article>

  
</section>


  <nav class="pagination">
    
    
    



    <a class="extend prev" rel="prev" href="/blogpost/page3"><i class="fa fa-angle-left"></i></a> <a class="page-number" href="/blogpost/">1</a> <span class="space">&hellip;</span> <a class="page-number" href="/blogpost/page3">3</a> <span class="page-number current">4</span> <a class="page-number" href="/blogpost/page5">5</a> <span class="space">&hellip;</span> <a class="page-number" href="/blogpost/page11">11</a> <a class="extend prev" rel="next" href="/blogpost/page5"><i class="fa fa-angle-right"></i></a>
  </nav>




          </div>
          


          

        </div>
        
          

  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/blogpost/assets/images/avatar.gif"
               alt="Max Hu" />
          <p class="site-author-name" itemprop="name">Max Hu</p>
           
              <p class="site-description motion-element" itemprop="description">Welcome!</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/blogpost/archives/">
                <span class="site-state-item-count">104</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/blogpost/categories/">
                <span class="site-state-item-count">71</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/blogpost/tags/">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
        
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>

        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Max Hu</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





















  
   
  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/jquery/index.js?v=2.1.3"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/blogpost/assets/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/blogpost/assets/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/blogpost/assets/js/src/motion.js?v=5.1.1"></script>



  
  

  <script type="text/javascript" src="/blogpost/assets/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/blogpost/assets/js/src/post-details.js?v=5.1.1"></script>


  


  <script type="text/javascript" src="/blogpost/assets/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  











  




  

    

  







  






  

  

  
  


  

  

  

</body>
</html>

